<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;sp-xp-d-liu&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;sp-xp-d-liu-ca-chng-ta&quot;,&quot;title&quot;:&quot;S·∫Øp x·∫øp d·ªØ li·ªáu c·ªßa ch√∫ng ta&quot;},{&quot;local&quot;:&quot;to-ra-cc-ct-mi&quot;,&quot;title&quot;:&quot;T·∫°o ra c√°c c·ªôt m·ªõi&quot;},{&quot;local&quot;:&quot;siu-sc-mnh-ca-hm-map&quot;,&quot;title&quot;:&quot;Si√™u s·ª©c m·∫°nh c·ªßa h√†m `map()`&quot;},{&quot;local&quot;:&quot;t-dataset-ti-dataframe-v-ngc-li&quot;,&quot;title&quot;:&quot;T·ª´ `Dataset` t·ªõi `DataFrame` v√† ng∆∞·ª£c l·∫°i&quot;},{&quot;local&quot;:&quot;to-ra-mt-tp-kim-nh&quot;,&quot;title&quot;:&quot;T·∫°o ra m·ªôt t·ªáp ki·ªÉm ƒë·ªãnh&quot;},{&quot;local&quot;:&quot;lu-mt-b-d-liu&quot;,&quot;title&quot;:&quot;L∆∞u m·ªôt b·ªô d·ªØ li·ªáu&quot;}],&quot;title&quot;:&quot;S·∫Øp x·∫øp d·ªØ li·ªáu&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/pr_298/vi/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/pr_298/vi/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_298/vi/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_298/vi/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_298/vi/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_298/vi/_app/pages/chapter5/3.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_298/vi/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_298/vi/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_298/vi/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_298/vi/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_298/vi/_app/chunks/DocNotebookDropdown-hf-doc-builder.js"> 





<h1 class="relative group"><a id="sp-xp-d-liu" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#sp-xp-d-liu"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>S·∫Øp x·∫øp d·ªØ li·ªáu
	</span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0"><a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter5/section3.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter5/section3.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<p>H·∫ßu h·∫øt th·ªùi gian, d·ªØ li·ªáu b·∫°n l√†m vi·ªác s·∫Ω ch∆∞a ƒë∆∞·ª£c chu·∫©n b·ªã ho√†n h·∫£o cho c√°c m√¥ h√¨nh hu·∫•n luy·ªán. Trong ph·∫ßn n√†y, ch√∫ng ta s·∫Ω kh√°m ph√° c√°c t√≠nh nƒÉng kh√°c nhau m√† ü§ó Datasets cung c·∫•p ƒë·ªÉ l√†m s·∫°ch c√°c t·∫≠p d·ªØ li·ªáu c·ªßa b·∫°n.</p>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/tqfSFcPMgOI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<h2 class="relative group"><a id="sp-xp-d-liu-ca-chng-ta" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#sp-xp-d-liu-ca-chng-ta"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>S·∫Øp x·∫øp d·ªØ li·ªáu c·ªßa ch√∫ng ta
	</span></h2>

<p>T∆∞∆°ng t·ª± nh∆∞ Pandas, ü§ó Datasets cung c·∫•p m·ªôt s·ªë t√≠nh nƒÉng ƒë·ªÉ thao t√∫ng n·ªôi dung c·ªßa <code>Dataset</code> v√† <code>DatasetDict</code>. Ch√∫ng ta ƒë√£ g·∫∑p ph∆∞∆°ng th·ª©c <code>Dataset.map()</code> trong <a href="/course/chapter3">Ch∆∞∆°ng 3</a> v√† trong ph·∫ßn n√†y, ch√∫ng ta s·∫Ω kh√°m ph√° m·ªôt s·ªë h√†m kh√°c theo √Ω c·ªßa ch√∫ng ta.</p>
<p>ƒê·ªëi v·ªõi v√≠ d·ª• n√†y, ch√∫ng t√¥i s·∫Ω s·ª≠ d·ª•ng <a href="https://archive.ics.uci.edu/ml/datasets/Drug+Review+Dataset+%28Drugs.com%29" rel="nofollow">B·ªô d·ªØ li·ªáu ƒë√°nh gi√° thu·ªëc</a> ƒë∆∞·ª£c l∆∞u tr·ªØ tr√™n <a href="https://archive.ics.uci.edu/ml/index.php" rel="nofollow">Kho l∆∞u tr·ªØ H·ªçc m√°y UC Irvine</a>, ch·ª©a c√°c ƒë√°nh gi√° c·ªßa b·ªánh nh√¢n v·ªÅ c√°c lo·∫°i thu·ªëc kh√°c nhau, c√πng v·ªõi t√¨nh tr·∫°ng ƒëang ƒë∆∞·ª£c ƒëi·ªÅu tr·ªã v√† x·∫øp h·∫°ng 10 sao v·ªÅ m·ª©c ƒë·ªô h√†i l√≤ng c·ªßa b·ªánh nh√¢n.</p>
<p>Tr∆∞·ªõc ti√™n, ch√∫ng ta c·∫ßn t·∫£i xu·ªëng v√† gi·∫£i n√©n d·ªØ li·ªáu, c√≥ th·ªÉ th·ª±c hi·ªán b·∫±ng l·ªánh <code>wget</code> v√†  <code>unzip</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->!wget <span class="hljs-string">&quot;https://archive.ics.uci.edu/ml/machine-learning-databases/00462/drugsCom_raw.zip&quot;</span>
!unzip drugsCom_raw.<span class="hljs-built_in">zip</span><!-- HTML_TAG_END --></pre></div>
<p>V√¨ TSV ch·ªâ l√† m·ªôt bi·∫øn th·ªÉ c·ªßa CSV s·ª≠ d·ª•ng d·∫•u tab thay v√¨ d·∫•u ph·∫©y l√†m d·∫•u ph√¢n c√°ch, ch√∫ng ta c√≥ th·ªÉ t·∫£i c√°c t·ªáp n√†y b·∫±ng c√°ch s·ª≠ d·ª•ng t·∫≠p l·ªánh t·∫£i <code>csv</code> v√† ch·ªâ ƒë·ªãnh ƒë·ªëi s·ªë <code>delimiter</code> trong h√†m <code>load_dataset()</code> nh∆∞ sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset

data_files = {<span class="hljs-string">&quot;train&quot;</span>: <span class="hljs-string">&quot;drugsComTrain_raw.tsv&quot;</span>, <span class="hljs-string">&quot;test&quot;</span>: <span class="hljs-string">&quot;drugsComTest_raw.tsv&quot;</span>}
<span class="hljs-comment"># \t is the tab character in Python</span>
drug_dataset = load_dataset(<span class="hljs-string">&quot;csv&quot;</span>, data_files=data_files, delimiter=<span class="hljs-string">&quot;\t&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>M·ªôt th·ª±c ti·ªÖn khi th·ª±c hi·ªán b·∫•t k·ª≥ lo·∫°i ph√¢n t√≠ch d·ªØ li·ªáu n√†o l√† l·∫•y m·ªôt m·∫´u ng·∫´u nhi√™n nh·ªè ƒë·ªÉ c√≥ th·ªÉ c·∫£m nh·∫≠n nhanh v·ªÅ lo·∫°i d·ªØ li·ªáu b·∫°n ƒëang l√†m vi·ªác. Trong ü§ó Datasets, ch√∫ng ta c√≥ th·ªÉ t·∫°o m·ªôt m·∫´u ng·∫´u nhi√™n b·∫±ng c√°ch x√¢u chu·ªói c√°c h√†m <code>Dataset.shuffle()</code> v√† <code>Dataset.select()</code> v·ªõi nhau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_sample = drug_dataset[<span class="hljs-string">&quot;train&quot;</span>].shuffle(seed=<span class="hljs-number">42</span>).select(<span class="hljs-built_in">range</span>(<span class="hljs-number">1000</span>))
<span class="hljs-comment"># Xem qua m·ªôt s·ªë v√≠ d·ª• ƒë·∫ßu ti√™n</span>
drug_sample[:<span class="hljs-number">3</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;Unnamed: 0&#x27;</span>: [<span class="hljs-number">87571</span>, <span class="hljs-number">178045</span>, <span class="hljs-number">80482</span>],
 <span class="hljs-string">&#x27;drugName&#x27;</span>: [<span class="hljs-string">&#x27;Naproxen&#x27;</span>, <span class="hljs-string">&#x27;Duloxetine&#x27;</span>, <span class="hljs-string">&#x27;Mobic&#x27;</span>],
 <span class="hljs-string">&#x27;condition&#x27;</span>: [<span class="hljs-string">&#x27;Gout, Acute&#x27;</span>, <span class="hljs-string">&#x27;ibromyalgia&#x27;</span>, <span class="hljs-string">&#x27;Inflammatory Conditions&#x27;</span>],
 <span class="hljs-string">&#x27;review&#x27;</span>: [<span class="hljs-string">&#x27;&quot;like the previous person mention, I&amp;#039;m a strong believer of aleve, it works faster for my gout than the prescription meds I take. No more going to the doctor for refills.....Aleve works!&quot;&#x27;</span>,
  <span class="hljs-string">&#x27;&quot;I have taken Cymbalta for about a year and a half for fibromyalgia pain. It is great\r\nas a pain reducer and an anti-depressant, however, the side effects outweighed \r\nany benefit I got from it. I had trouble with restlessness, being tired constantly,\r\ndizziness, dry mouth, numbness and tingling in my feet, and horrible sweating. I am\r\nbeing weaned off of it now. Went from 60 mg to 30mg and now to 15 mg. I will be\r\noff completely in about a week. The fibro pain is coming back, but I would rather deal with it than the side effects.&quot;&#x27;</span>,
  <span class="hljs-string">&#x27;&quot;I have been taking Mobic for over a year with no side effects other than an elevated blood pressure.  I had severe knee and ankle pain which completely went away after taking Mobic.  I attempted to stop the medication however pain returned after a few days.&quot;&#x27;</span>],
 <span class="hljs-string">&#x27;rating&#x27;</span>: [<span class="hljs-number">9.0</span>, <span class="hljs-number">3.0</span>, <span class="hljs-number">10.0</span>],
 <span class="hljs-string">&#x27;date&#x27;</span>: [<span class="hljs-string">&#x27;September 2, 2015&#x27;</span>, <span class="hljs-string">&#x27;November 7, 2011&#x27;</span>, <span class="hljs-string">&#x27;June 5, 2013&#x27;</span>],
 <span class="hljs-string">&#x27;usefulCount&#x27;</span>: [<span class="hljs-number">36</span>, <span class="hljs-number">13</span>, <span class="hljs-number">128</span>]}<!-- HTML_TAG_END --></pre></div>
<p>L∆∞u √Ω r·∫±ng ch√∫ng ta ƒë√£ s·ª≠a seed trong <code>Dataset.shuffle()</code> cho m·ª•c ƒë√≠ch t√°i t·∫°o.  <code>Dataset.select()</code> mong ƒë·ª£i m·ªôt ch·ªâ s·ªë c√≥ th·ªÉ l·∫∑p l·∫°i, v√¨ v·∫≠y ch√∫ng ta truy·ªÅn v√†o kho·∫£ng <code>range(1000)</code> ƒë·ªÉ l·∫•y 1,000 m·∫´u ƒë·∫ßu ti√™n t·ª´ t·∫≠p d·ªØ li·ªáu ƒë√£ x√°o tr·ªôn. T·ª´ m·∫´u n√†y, ta ƒë√£ c√≥ th·ªÉ th·∫•y m·ªôt s·ªë ƒëi·ªÅu k·ª≥ qu·∫∑c trong t·∫≠p d·ªØ li·ªáu:</p>
<ul><li>C·ªôt <code>Unnamed: 0</code>  tr√¥ng ƒë√°ng ng·ªù gi·ªëng nh∆∞ m·ªôt ID ·∫©n danh cho m·ªói b·ªánh nh√¢n.</li>
<li>C·ªôt <code>condition</code> bao g·ªìm s·ª± k·∫øt h·ª£p gi·ªØa c√°c nh√£n ch·ªØ hoa v√† ch·ªØ th∆∞·ªùng.</li>
<li>C√°c b√†i ƒë√°nh gi√° c√≥ ƒë·ªô d√†i kh√°c nhau v√† ch·ª©a h·ªón h·ª£p c√°c d·∫•u ph√¢n t√°ch d√≤ng Python (<code>\r\n</code>) c≈©ng nh∆∞ c√°c m√£ k√Ω t·ª± HTML nh∆∞ <code>&amp;\#039;</code>.</li></ul>
<p>H√£y xem c√°ch ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng ü§ó Datasets ƒë·ªÉ gi·∫£i quy·∫øt t·ª´ng v·∫•n ƒë·ªÅ n√†y. ƒê·ªÉ ki·ªÉm tra gi·∫£ thuy·∫øt ID b·ªánh nh√¢n cho c·ªôt <code>Unnamed: 0</code>, ta c√≥ th·ªÉ s·ª≠ d·ª•ng h√†m  <code>Dataset.unique()</code> ƒë·ªÉ x√°c minh r·∫±ng s·ªë l∆∞·ª£ng ID kh·ªõp v·ªõi s·ªë h√†ng trong m·ªói l·∫ßn t√°ch:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">for</span> split <span class="hljs-keyword">in</span> drug_dataset.keys():
    <span class="hljs-keyword">assert</span> <span class="hljs-built_in">len</span>(drug_dataset[split]) == <span class="hljs-built_in">len</span>(drug_dataset[split].unique(<span class="hljs-string">&quot;Unnamed: 0&quot;</span>))<!-- HTML_TAG_END --></pre></div>
<p>ƒêi·ªÅu n√†y d∆∞·ªùng nh∆∞ x√°c nh·∫≠n gi·∫£ thuy·∫øt c·ªßa ch√∫ng t√¥i, v√¨ v·∫≠y h√£y d·ªçn d·∫πp t·∫≠p d·ªØ li·ªáu m·ªôt ch√∫t b·∫±ng c√°ch ƒë·ªïi t√™n c·ªôt <code>Unname: 0</code> th√†nh m·ªôt c√°i g√¨ ƒë√≥ d·ªÖ hi·ªÉu h∆°n m·ªôt ch√∫t. Ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng h√†m <code>DatasetDict.rename_column()</code> ƒë·ªÉ ƒë·ªïi t√™n c·ªôt tr√™n c·∫£ hai t·∫≠p con trong m·ªôt l·∫ßn:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset = drug_dataset.rename_column(
    original_column_name=<span class="hljs-string">&quot;Unnamed: 0&quot;</span>, new_column_name=<span class="hljs-string">&quot;patient_id&quot;</span>
)
drug_dataset<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>],
        num_rows: <span class="hljs-number">161297</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>],
        num_rows: <span class="hljs-number">53766</span>
    })
})<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>‚úèÔ∏è <strong>Th·ª≠ nghi·ªám th√¥i!</strong> S·ª≠ d·ª•ng h√†m <code>Dataset.unique()</code> ƒë·ªÉ t√¨m s·ªë l∆∞·ª£ng thu·ªëc ƒë·ªôc nh·∫•t v√† ƒëi·ªÅu ki·ªán trong t·∫≠p hu·∫•n luy·ªán v√† ki·ªÉm th·ª≠.</p></div>
<p>Ti·∫øp theo, h√£y chu·∫©n h√≥a t·∫•t c·∫£ c√°c nh√£n <code>condition</code> b·∫±ng c√°ch s·ª≠ d·ª•ng <code>Dataset.map()</code>. Nh∆∞ ch√∫ng ta ƒë√£ l√†m v·ªõi tokenize trong <a href="/course/chapter3">Ch∆∞∆°ng 3</a>, ch√∫ng ta c√≥ th·ªÉ x√°c ƒë·ªãnh m·ªôt h√†m ƒë∆°n gi·∫£n c√≥ th·ªÉ ƒë∆∞·ª£c √°p d·ª•ng tr√™n t·∫•t c·∫£ c√°c h√†ng c·ªßa m·ªói t·∫≠p trong <code>drug_dataset</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">lowercase_condition</span>(<span class="hljs-params">example</span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">&quot;condition&quot;</span>: example[<span class="hljs-string">&quot;condition&quot;</span>].lower()}


drug_dataset.<span class="hljs-built_in">map</span>(lowercase_condition)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->AttributeError: <span class="hljs-string">&#x27;NoneType&#x27;</span> <span class="hljs-built_in">object</span> has no attribute <span class="hljs-string">&#x27;lower&#x27;</span><!-- HTML_TAG_END --></pre></div>
<p>·ªí kh√¥ng, ch√∫ng ta ƒë√£ g·∫∑p s·ª± c·ªë v·ªõi ch·ª©c nƒÉng n·ªëi c·ªßa m√¨nh! T·ª´ l·ªói, ch√∫ng ta c√≥ th·ªÉ suy ra r·∫±ng m·ªôt s·ªë m·ª•c nh·∫≠p trong c·ªôt <code>condition</code> l√† <code>None</code>, kh√¥ng th·ªÉ vi·∫øt th∆∞·ªùng v√¨ ch√∫ng kh√¥ng ph·∫£i l√† chu·ªói. H√£y b·ªè c√°c h√†ng n√†y b·∫±ng c√°ch s·ª≠ d·ª•ng <code>Dataset.filter()</code>, ho·∫°t ƒë·ªông theo c√°ch t∆∞∆°ng t·ª± nh∆∞ <code>Dataset.map()</code> v√† mong ƒë·ª£i m·ªôt h√†m nh·∫≠n ƒë∆∞·ª£c m·ªôt m·∫´u v·ªÅ t·∫≠p d·ªØ li·ªáu. Thay v√¨ vi·∫øt m·ªôt h√†m r√µ r√†ng nh∆∞:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">filter_nones</span>(<span class="hljs-params">x</span>):
    <span class="hljs-keyword">return</span> x[<span class="hljs-string">&quot;condition&quot;</span>] <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span><!-- HTML_TAG_END --></pre></div>
<p>v√† sau ƒë√≥ ch·∫°y <code>drug_dataset.filter(filter_nones)</code>, ch√∫ng ta c√≥ th·ªÉ th·ª±c hi·ªán vi·ªác n√†y trong m·ªôt d√≤ng b·∫±ng c√°ch s·ª≠ d·ª•ng <em>h√†m lambda</em>. Trong Python, c√°c h√†m lambda l√† c√°c h√†m nh·ªè m√† b·∫°n c√≥ th·ªÉ ƒë·ªãnh nghƒ©a m√† kh√¥ng c·∫ßn ƒë·∫∑t t√™n r√µ r√†ng. Ch√∫ng c√≥ d·∫°ng chung:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->lambda <span class="hljs-tag">&lt;<span class="hljs-name">arguments</span>&gt;</span> : <span class="hljs-tag">&lt;<span class="hljs-name">expression</span>&gt;</span><!-- HTML_TAG_END --></pre></div>
<p>·ªü ƒë√¢y <code>lambda</code> l√† m·ªôt trong nh·ªØng <a href="https://docs.python.org/3/reference/lexical_analysis.html#keywords" rel="nofollow">t·ª´ kh√≥a</a> ƒë·∫∑c bi·ªát c·ªßa Python, <code>&lt;arguments&gt;</code> l√† danh s√°ch / t·∫≠p h·ª£p c√°c gi√° tr·ªã ƒë∆∞·ª£c ph√¢n t√°ch b·∫±ng d·∫•u ph·∫©y x√°c ƒë·ªãnh c√°c ƒë·∫ßu v√†o cho h√†m v√† <code>&lt;expression&gt;</code>  ƒë·∫°i di·ªán cho c√°c ho·∫°t ƒë·ªông b·∫°n mu·ªën th·ª±c hi·ªán. V√≠ d·ª•, ch√∫ng ta c√≥ th·ªÉ ƒë·ªãnh nghƒ©a m·ªôt h√†m lambda ƒë∆°n gi·∫£n b√¨nh ph∆∞∆°ng m·ªôt s·ªë nh∆∞ sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->lambda <span class="hljs-keyword">x</span> : <span class="hljs-keyword">x</span> * <span class="hljs-keyword">x</span><!-- HTML_TAG_END --></pre></div>
<p>ƒê·ªÉ √°p d·ª•ng h√†m n√†y cho m·ªôt ƒë·∫ßu v√†o, ch√∫ng ta c·∫ßn ƒë·∫∑t n√≥ v√† ƒë·∫ßu v√†o trong d·∫•u ngo·∫∑c ƒë∆°n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->(<span class="hljs-keyword">lambda</span> x: x * x)(<span class="hljs-number">3</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-number">9</span><!-- HTML_TAG_END --></pre></div>
<p>T∆∞∆°ng t·ª±, ch√∫ng ta c√≥ th·ªÉ ƒë·ªãnh nghƒ©a c√°c h√†m lambda v·ªõi nhi·ªÅu tham s·ªë b·∫±ng c√°ch ph√¢n t√°ch ch√∫ng b·∫±ng d·∫•u ph·∫©y. V√≠ d·ª•, ch√∫ng ta c√≥ th·ªÉ t√≠nh di·ªán t√≠ch c·ªßa m·ªôt tam gi√°c nh∆∞ sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->(<span class="hljs-keyword">lambda</span> base, height: <span class="hljs-number">0.5</span> * base * height)(<span class="hljs-number">4</span>, <span class="hljs-number">8</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-number">16.0</span><!-- HTML_TAG_END --></pre></div>
<p>C√°c h√†m Lambda r·∫•t h·ªØu √≠ch khi b·∫°n mu·ªën ƒë·ªãnh nghƒ©a c√°c h√†m nh·ªè, s·ª≠ d·ª•ng m·ªôt l·∫ßn (ƒë·ªÉ bi·∫øt th√™m th√¥ng tin v·ªÅ ch√∫ng, ch√∫ng t√¥i khuy√™n b·∫°n n√™n ƒë·ªçc <a href="https://realpython.com/python-lambda/" rel="nofollow">H∆∞·ªõng d·∫´n Python ƒë√≠ch th·ª±c</a> c·ªßa Andre Burgaud). Trong ng·ªØ c·∫£nh ü§ó Datasets, ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng c√°c h√†m lambda ƒë·ªÉ x√°c ƒë·ªãnh c√°c ho·∫°t ƒë·ªông n·ªëi v√† l·ªçc ƒë∆°n gi·∫£n, v√¨ v·∫≠y h√£y s·ª≠ d·ª•ng th·ªß thu·∫≠t n√†y ƒë·ªÉ lo·∫°i b·ªè c√°c ph·∫ßn <code>None</code> trong t·∫≠p d·ªØ li·ªáu:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset = drug_dataset.<span class="hljs-built_in">filter</span>(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">&quot;condition&quot;</span>] <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span> <span class="hljs-literal">None</span>)<!-- HTML_TAG_END --></pre></div>
<p>V·ªõi <code>None</code> ƒë√£ b·ªã x√≥a, ch√∫ng ta  c√≥ th·ªÉ chu·∫©n h√≥a c·ªôt <code>condition</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset = drug_dataset.<span class="hljs-built_in">map</span>(lowercase_condition)
<span class="hljs-comment"># Ki·ªÉm tra xem ch·ªØ vi·∫øt th∆∞·ªùng ƒë√£ ho·∫°t ƒë·ªông ch∆∞a</span>
drug_dataset[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-string">&quot;condition&quot;</span>][:<span class="hljs-number">3</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-string">&#x27;left ventricular dysfunction&#x27;</span>, <span class="hljs-string">&#x27;adhd&#x27;</span>, <span class="hljs-string">&#x27;birth control&#x27;</span>]<!-- HTML_TAG_END --></pre></div>
<p>N√≥ ho·∫°t ƒë·ªông! V·∫≠y l√† ch√∫ng ta ƒë√£ l√†m s·∫°ch c√°c nh√£n, gi·ªù ch√∫ng ta h√£y xem x√©t vi·ªác l√†m s·∫°ch c√°c b√†i ƒë√°nh gi√°.</p>
<h2 class="relative group"><a id="to-ra-cc-ct-mi" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#to-ra-cc-ct-mi"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>T·∫°o ra c√°c c·ªôt m·ªõi
	</span></h2>

<p>B·∫•t c·ª© khi n√†o b·∫°n x·ª≠ l√Ω c√°c b√†i ƒë√°nh gi√° c·ªßa kh√°ch h√†ng, m·ªôt ph∆∞∆°ng ph√°p hay ƒë√≥ l√† ki·ªÉm tra s·ªë l∆∞·ª£ng t·ª´ trong m·ªói b√†i ƒë√°nh gi√°. B√†i ƒë√°nh gi√° c√≥ th·ªÉ ch·ªâ l√† m·ªôt t·ª´ duy nh·∫•t nh∆∞ ‚ÄúTuy·ªát v·ªùi!‚Äù ho·∫∑c m·ªôt b√†i lu·∫≠n ƒë·∫ßy ƒë·ªß v·ªõi h√†ng ngh√¨n t·ª´, v√† t√πy thu·ªôc v√†o tr∆∞·ªùng h·ª£p s·ª≠ d·ª•ng, b·∫°n s·∫Ω c·∫ßn x·ª≠ l√Ω nh·ªØng th√°i c·ª±c n√†y theo c√°ch kh√°c nhau. ƒê·ªÉ t√≠nh to√°n s·ªë l∆∞·ª£ng t·ª´ trong m·ªói b√†i ƒë√°nh gi√°, ch√∫ng t√¥i s·∫Ω s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p ph·ªèng ƒëo√°n s∆° b·ªô d·ª±a tr√™n vi·ªác t√°ch t·ª´ng vƒÉn b·∫£n theo kho·∫£ng tr·∫Øng.</p>
<p>H√£y ƒë·ªãnh nghƒ©a m·ªôt h√†m ƒë∆°n gi·∫£n ƒë·∫øm s·ªë t·ª´ trong m·ªói b√†i ƒë√°nh gi√°:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_review_length</span>(<span class="hljs-params">example</span>):
    <span class="hljs-keyword">return</span> {<span class="hljs-string">&quot;review_length&quot;</span>: <span class="hljs-built_in">len</span>(example[<span class="hljs-string">&quot;review&quot;</span>].split())}<!-- HTML_TAG_END --></pre></div>
<p>Kh√¥ng gi·ªëng nh∆∞ h√†m <code>lowercase_condition()</code>, <code>compute_review_length()</code> tr·∫£ v·ªÅ m·ªôt t·ª´ ƒëi·ªÉn c√≥ kh√≥a kh√¥ng t∆∞∆°ng ·ª©ng v·ªõi m·ªôt trong c√°c t√™n c·ªôt trong t·∫≠p d·ªØ li·ªáu. Trong tr∆∞·ªùng h·ª£p n√†y, khi <code>compute_review_length()</code> ƒë∆∞·ª£c truy·ªÅn v√†o <code>Dataset.map()</code>, n√≥ s·∫Ω ƒë∆∞·ª£c √°p d·ª•ng cho t·∫•t c·∫£ c√°c h√†ng trong t·∫≠p d·ªØ li·ªáu ƒë·ªÉ t·∫°o c·ªôt m·ªõi <code>review_length</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset = drug_dataset.<span class="hljs-built_in">map</span>(compute_review_length)
<span class="hljs-comment"># Ki·ªÉm tra m·∫´u hu·∫•n luy·ªán ƒë·∫ßu ti√™n</span>
drug_dataset[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;patient_id&#x27;</span>: <span class="hljs-number">206461</span>,
 <span class="hljs-string">&#x27;drugName&#x27;</span>: <span class="hljs-string">&#x27;Valsartan&#x27;</span>,
 <span class="hljs-string">&#x27;condition&#x27;</span>: <span class="hljs-string">&#x27;left ventricular dysfunction&#x27;</span>,
 <span class="hljs-string">&#x27;review&#x27;</span>: <span class="hljs-string">&#x27;&quot;It has no side effect, I take it in combination of Bystolic 5 Mg and Fish Oil&quot;&#x27;</span>,
 <span class="hljs-string">&#x27;rating&#x27;</span>: <span class="hljs-number">9.0</span>,
 <span class="hljs-string">&#x27;date&#x27;</span>: <span class="hljs-string">&#x27;May 20, 2012&#x27;</span>,
 <span class="hljs-string">&#x27;usefulCount&#x27;</span>: <span class="hljs-number">27</span>,
 <span class="hljs-string">&#x27;review_length&#x27;</span>: <span class="hljs-number">17</span>}<!-- HTML_TAG_END --></pre></div>
<p>Nh∆∞ mong ƒë·ª£i, ch√∫ng ta c√≥ th·ªÉ th·∫•y c·ªôt <code>review_length</code> ƒë√£ ƒë∆∞·ª£c th√™m v√†o t·∫≠p hu·∫•n luy·ªán c·ªßa ch√∫ng ta. Ch√∫ng ta c√≥ th·ªÉ s·∫Øp x·∫øp c·ªôt m·ªõi n√†y v·ªõi <code>Dataset.sort()</code> ƒë·ªÉ xem c√°c gi√° tr·ªã c·ª±c ƒë·∫°i tr√¥ng nh∆∞ th·∫ø n√†o:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset[<span class="hljs-string">&quot;train&quot;</span>].sort(<span class="hljs-string">&quot;review_length&quot;</span>)[:<span class="hljs-number">3</span>]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;patient_id&#x27;</span>: [<span class="hljs-number">103488</span>, <span class="hljs-number">23627</span>, <span class="hljs-number">20558</span>],
 <span class="hljs-string">&#x27;drugName&#x27;</span>: [<span class="hljs-string">&#x27;Loestrin 21 1 / 20&#x27;</span>, <span class="hljs-string">&#x27;Chlorzoxazone&#x27;</span>, <span class="hljs-string">&#x27;Nucynta&#x27;</span>],
 <span class="hljs-string">&#x27;condition&#x27;</span>: [<span class="hljs-string">&#x27;birth control&#x27;</span>, <span class="hljs-string">&#x27;muscle spasm&#x27;</span>, <span class="hljs-string">&#x27;pain&#x27;</span>],
 <span class="hljs-string">&#x27;review&#x27;</span>: [<span class="hljs-string">&#x27;&quot;Excellent.&quot;&#x27;</span>, <span class="hljs-string">&#x27;&quot;useless&quot;&#x27;</span>, <span class="hljs-string">&#x27;&quot;ok&quot;&#x27;</span>],
 <span class="hljs-string">&#x27;rating&#x27;</span>: [<span class="hljs-number">10.0</span>, <span class="hljs-number">1.0</span>, <span class="hljs-number">6.0</span>],
 <span class="hljs-string">&#x27;date&#x27;</span>: [<span class="hljs-string">&#x27;November 4, 2008&#x27;</span>, <span class="hljs-string">&#x27;March 24, 2017&#x27;</span>, <span class="hljs-string">&#x27;August 20, 2016&#x27;</span>],
 <span class="hljs-string">&#x27;usefulCount&#x27;</span>: [<span class="hljs-number">5</span>, <span class="hljs-number">2</span>, <span class="hljs-number">10</span>],
 <span class="hljs-string">&#x27;review_length&#x27;</span>: [<span class="hljs-number">1</span>, <span class="hljs-number">1</span>, <span class="hljs-number">1</span>]}<!-- HTML_TAG_END --></pre></div>
<p>Nh∆∞ ta ƒë√£ nghi v·∫•n, m·ªôt s·ªë ƒë√°nh gi√° ch·ªâ ch·ª©a m·ªôt t·ª´ duy nh·∫•t, m·∫∑c d√π c√≥ th·ªÉ ·ªïn ƒë·ªÉ ph√¢n t√≠ch s·∫Øc th√°i, nh∆∞ng s·∫Ω kh√¥ng c√≥ nhi·ªÅu th√¥ng tin n·∫øu ch√∫ng t√¥i mu·ªën d·ª± ƒëo√°n t√¨nh tr·∫°ng b·ªánh.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>üôã M·ªôt c√°ch thay th·∫ø ƒë·ªÉ th√™m c√°c c·ªôt m·ªõi v√†o t·∫≠p d·ªØ li·ªáu l√† s·ª≠ d·ª•ng h√†m <code>Dataset.add_column()</code>. ƒêi·ªÅu n√†y cho ph√©p b·∫°n cung c·∫•p c·ªôt d∆∞·ªõi d·∫°ng danh s√°ch Python ho·∫∑c m·∫£ng NumPy v√† c√≥ th·ªÉ h·ªØu √≠ch trong c√°c tr∆∞·ªùng h·ª£p m√† <code>Dataset.map()</code> kh√¥ng ph√π h·ª£p cho ph√¢n t√≠ch c·ªßa b·∫°n.</p></div>
<p>H√£y s·ª≠ d·ª•ng h√†m <code>Dataset.filter()</code> ƒë·ªÉ x√≥a c√°c b√†i ƒë√°nh gi√° c√≥ √≠t h∆°n 30 t·ª´. T∆∞∆°ng t·ª± nh∆∞ nh·ªØng g√¨ ch√∫ng ta ƒë√£ l√†m v·ªõi c·ªôt <code>condition</code>, ch√∫ng ta c√≥ th·ªÉ l·ªçc ra c√°c b√†i ƒë√°nh gi√° r·∫•t ng·∫Øn b·∫±ng c√°ch y√™u c·∫ßu c√°c b√†i ƒë√°nh gi√° c√≥ ƒë·ªô d√†i tr√™n ng∆∞·ª°ng n√†y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset = drug_dataset.<span class="hljs-built_in">filter</span>(<span class="hljs-keyword">lambda</span> x: x[<span class="hljs-string">&quot;review_length&quot;</span>] &gt; <span class="hljs-number">30</span>)
<span class="hljs-built_in">print</span>(drug_dataset.num_rows)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;train&#x27;</span>: <span class="hljs-number">138514</span>, <span class="hljs-string">&#x27;test&#x27;</span>: <span class="hljs-number">46108</span>}<!-- HTML_TAG_END --></pre></div>
<p>Nh∆∞ b·∫°n c√≥ th·ªÉ th·∫•y, ƒëi·ªÅu n√†y ƒë√£ lo·∫°i b·ªè kho·∫£ng 15% b√†i ƒë√°nh gi√° kh·ªèi b·ªô hu·∫•n luy·ªán v√† ki·ªÉm th·ª≠ ban ƒë·∫ßu.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>‚úèÔ∏è <strong>Th·ª≠ nghi·ªám th√¥i!</strong> S·ª≠ d·ª•ng h√†m <code>Dataset.sort()</code> ƒë·ªÉ ki·ªÉm tra c√°c b√†i ƒë√°nh gi√° c√≥ s·ªë l∆∞·ª£ng t·ª´ l·ªõn nh·∫•t. Tham kh·∫£o <a href="https://huggingface.co/docs/datasets/package_reference/main_classes.html#datasets.Dataset.sort" rel="nofollow">t√†i li·ªáu</a> ƒë·ªÉ bi·∫øt b·∫°n c·∫ßn s·ª≠ d·ª•ng tham s·ªë n√†o ƒë·ªÉ s·∫Øp x·∫øp c√°c b√†i ƒë√°nh gi√° theo th·ª© t·ª± gi·∫£m d·∫ßn.</p></div>
<p>ƒêi·ªÅu cu·ªëi c√πng ch√∫ng ta c·∫ßn gi·∫£i quy·∫øt l√† s·ª± hi·ªán di·ªán c·ªßa k√Ω t·ª± HTML trong c√°c b√†i ƒë√°nh gi√° c·ªßa ch√∫ng ta. Ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng m√¥-ƒëun <code>html</code> c·ªßa Python ƒë·ªÉ lo·∫°i b·ªè qua c√°c k√Ω t·ª± n√†y, nh∆∞ sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> html

text = <span class="hljs-string">&quot;I&amp;#039;m a transformer called BERT&quot;</span>
html.unescape(text)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-string">&quot;I&#x27;m a transformer called BERT&quot;</span><!-- HTML_TAG_END --></pre></div>
<p>Ta s·∫Ω s·ª≠ d·ª•ng <code>Dataset.map()</code> ƒë·ªÉ h·ªßy t·∫•t c·∫£ c√°c k√Ω t·ª± HTML trong kho t√†i li·ªáu c·ªßa m√¨nh:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset = drug_dataset.<span class="hljs-built_in">map</span>(<span class="hljs-keyword">lambda</span> x: {<span class="hljs-string">&quot;review&quot;</span>: html.unescape(x[<span class="hljs-string">&quot;review&quot;</span>])})<!-- HTML_TAG_END --></pre></div>
<p>Nh∆∞ b·∫°n c√≥ th·ªÉ th·∫•y, ph∆∞∆°ng th·ª©c <code>Dataset.map()</code> kh√° h·ªØu √≠ch ƒë·ªÉ x·ª≠ l√Ω d·ªØ li·ªáu - v√† ch√∫ng ta th·∫≠m ch√≠ c√≤n ch∆∞a r√µ t·∫•t m·ªçi th·ª© m√† n√≥ c√≥ th·ªÉ l√†m!</p>
<h2 class="relative group"><a id="siu-sc-mnh-ca-hm-map" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#siu-sc-mnh-ca-hm-map"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Si√™u s·ª©c m·∫°nh c·ªßa h√†m <code>map()</code></span></h2>

<p>Ph∆∞∆°ng th·ª©c <code>Dataset.map ()</code> nh·∫≠n tham s·ªë <code>batched</code>, n·∫øu ƒë∆∞·ª£c ƒë·∫∑t th√†nh <code>True</code>, n√≥ s·∫Ω g·ª≠i m·ªôt lo·∫°t c√°c m·∫´u ƒë·∫øn h√†m map c√πng m·ªôt l√∫c (ta c√≥ th·ªÉ c·∫•u h√¨nh k√≠ch th∆∞·ªõc l√¥ nh∆∞ng m·∫∑c ƒë·ªãnh l√† 1,000). V√≠ d·ª•: h√†m map tr∆∞·ªõc ƒë√≥ lo·∫°i b·ªè t·∫•t c·∫£ HTML ƒë√£ m·∫•t m·ªôt ch√∫t th·ªùi gian ƒë·ªÉ ch·∫°y (b·∫°n c√≥ th·ªÉ ƒë·ªçc th·ªùi gian th·ª±c hi·ªán t·ª´ c√°c thanh ti·∫øn tr√¨nh). Ch√∫ng ta c√≥ th·ªÉ tƒÉng t·ªëc ƒë·ªô n√†y b·∫±ng c√°ch x·ª≠ l√Ω m·ªôt s·ªë ph·∫ßn t·ª≠ c√πng l√∫c th√¥ng qua s·ª≠ d·ª•ng bao h√†m.</p>
<p>Khi b·∫°n ch·ªâ ƒë·ªãnh <code>batched=True</code>, h√†m s·∫Ω nh·∫≠n m·ªôt t·ª´ ƒëi·ªÉn v·ªõi c√°c tr∆∞·ªùng c·ªßa t·∫≠p d·ªØ li·ªáu, nh∆∞ng m·ªói gi√° tr·ªã b√¢y gi·ªù l√† m·ªôt <em>danh s√°ch c√°c gi√° tr·ªã</em> v√† kh√¥ng ch·ªâ l√† m·ªôt gi√° tr·ªã duy nh·∫•t. Gi√° tr·ªã tr·∫£ v·ªÅ c·ªßa <code>Dataset.map()</code> ph·∫£i gi·ªëng nhau: m·ªôt t·ª´ ƒëi·ªÉn v·ªõi c√°c tr∆∞·ªùng ta mu·ªën c·∫≠p nh·∫≠t ho·∫∑c th√™m v√†o t·∫≠p d·ªØ li·ªáu c·ªßa m√¨nh v√† m·ªôt danh s√°ch c√°c gi√° tr·ªã. V√≠ d·ª•: ƒë√¢y l√† m·ªôt c√°ch kh√°c ƒë·ªÉ h·ªßy t·∫•t c·∫£ c√°c k√Ω t·ª± HTML, nh∆∞ng s·ª≠ d·ª•ng <code>batched=True</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->new_drug_dataset = drug_dataset.<span class="hljs-built_in">map</span>(
    <span class="hljs-keyword">lambda</span> x: {<span class="hljs-string">&quot;review&quot;</span>: [html.unescape(o) <span class="hljs-keyword">for</span> o <span class="hljs-keyword">in</span> x[<span class="hljs-string">&quot;review&quot;</span>]]}, batched=<span class="hljs-literal">True</span>
)<!-- HTML_TAG_END --></pre></div>
<p>N·∫øu b·∫°n ƒëang ch·∫°y ƒëo·∫°n m√£ n√†y tr√™n notebook, b·∫°n s·∫Ω th·∫•y r·∫±ng l·ªánh n√†y th·ª±c thi nhanh h∆°n l·ªánh tr∆∞·ªõc ƒë√≥. V√† ƒë√≥ kh√¥ng ph·∫£i l√† do c√°c b√†i ƒë√°nh gi√° c·ªßa ch√∫ng t√¥i ƒë√£ ƒë∆∞·ª£c lo·∫°i ƒëi HTML - n·∫øu b·∫°n th·ª±c hi·ªán l·∫°i h∆∞·ªõng d·∫´n t·ª´ ph·∫ßn tr∆∞·ªõc (kh√¥ng c√≥ <code>batch = True</code>), n√≥ s·∫Ω m·∫•t c√πng m·ªôt kho·∫£ng th·ªùi gian nh∆∞ tr∆∞·ªõc. ƒêi·ªÅu n√†y l√† do vi·ªác bao h√†m th∆∞·ªùng nhanh h∆°n vi·ªác th·ª±c thi c√πng m·ªôt ƒëo·∫°n m√£ trong v√≤ng l·∫∑p <code>for</code> v√† ch√∫ng ta c≈©ng ƒë·∫°t ƒë∆∞·ª£c m·ªôt s·ªë hi·ªáu su·∫•t b·∫±ng c√°ch truy c·∫≠p nhi·ªÅu ph·∫ßn t·ª≠ c√πng m·ªôt l√∫c thay v√¨ t·ª´ng ph·∫ßn t·ª≠ m·ªôt.</p>
<p>S·ª≠ d·ª•ng <code>Dataset.map()</code> v·ªõi <code>batched=True</code> s·∫Ω l√† ƒëi·ªÅu c·∫ßn thi·∫øt ƒë·ªÉ m·ªü kh√≥a t·ªëc ƒë·ªô c·ªßa c√°c tr√¨nh tokenize ‚Äúnhanh‚Äù m√† ch√∫ng ta s·∫Ω g·∫∑p trong <a href="/course/chap6">Ch∆∞∆°ng 6</a>, c√≥ th·ªÉ nhanh ch√≥ng tokenize c√°c danh s√°ch l·ªõn c√°c vƒÉn b·∫£n. V√≠ d·ª•: ƒë·ªÉ tokenize t·∫•t c·∫£ c√°c ƒë√°nh gi√° thu·ªëc b·∫±ng tr√¨nh tokenize nhanh, ta c√≥ th·ªÉ s·ª≠ d·ª•ng m·ªôt h√†m nh∆∞ sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer

tokenizer = AutoTokenizer.from_pretrained(<span class="hljs-string">&quot;bert-base-cased&quot;</span>)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize_function</span>(<span class="hljs-params">examples</span>):
    <span class="hljs-keyword">return</span> tokenizer(examples[<span class="hljs-string">&quot;review&quot;</span>], truncation=<span class="hljs-literal">True</span>)<!-- HTML_TAG_END --></pre></div>
<p>Nh∆∞ b·∫°n ƒë√£ th·∫•y trong <a href="/course/chapter3">Ch∆∞∆°ng 3</a>, ch√∫ng ta c√≥ th·ªÉ truy·ªÅn v√†o m·ªôt ho·∫∑c nhi·ªÅu m·∫´u cho tokenizer, v√¨ v·∫≠y ta c√≥ th·ªÉ s·ª≠ d·ª•ng h√†m n√†y v·ªõi <code>batched=True</code> ho·∫∑c kh√¥ng. H√£y c≈©ng coi ƒë√¢y l√† m·ªôt c∆° h·ªôi ƒë·ªÉ so s√°nh hi·ªáu nƒÉng c·ªßa hai tu·ª≥ ch·ªçn n√†y. Trong m·ªôt notebook, b·∫°n c√≥ th·ªÉ b·∫•m gi·ªù ch·ªâ v·ªõi m·ªôt d√≤ng l·ªánh <code>%time</code> tr∆∞·ªõc d√≤ng m√£ b·∫°n mu·ªën t√¨nh th·ªùi gian:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->%time tokenized_dataset = drug_dataset.<span class="hljs-built_in">map</span>(tokenize_function, batched=<span class="hljs-literal">True</span>)<!-- HTML_TAG_END --></pre></div>
<p>B·∫°n c≈©ng c√≥ th·ªÉ t√≠nh th·ªùi gian cho to√†n b·ªô √¥ b·∫±ng c√°ch ƒë·∫∑t <code>%%time</code> ·ªü ƒë·∫ßu c·ªßa √¥ m√£. Tr√™n ph·∫ßn c·ª©ng m√† ch√∫ng ta th·ª±c hi·ªán, n√≥ hi·ªÉn th·ªã 10.8 gi√¢y cho l·ªánh n√†y (ƒë√≥ l√† s·ªë ƒë∆∞·ª£c vi·∫øt sau ‚ÄúWall time‚Äù).</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>‚úèÔ∏è <strong>Th·ª≠ nghi·ªám th√¥i!</strong> Th·ª±c hi·ªán c√πng m·ªôt h∆∞·ªõng d·∫´n c√≥ v√† kh√¥ng c√≥ <code>batched=True</code>, sau ƒë√≥ th·ª≠ n√≥ v·ªõi tokenizer ch·∫≠m (th√™m <code>use_fast=False</code> v√†o <code>AutoTokenizer.from_pretrained()</code>) ƒë·ªÉ b·∫°n c√≥ th·ªÉ th·∫•y gi√° tr·ªã b·∫°n nh·∫≠n ƒë∆∞·ª£c tr√™n ph·∫ßn c·ª©ng c·ªßa m√¨nh.</p></div>
<p>D∆∞·ªõi ƒë√¢y l√† k·∫øt qu·∫£ thu ƒë∆∞·ª£c khi c√≥ v√† kh√¥ng c√≥ t√≠nh nƒÉng ph√¢n l√¥, v·ªõi tokenizer nhanh v√† ch·∫≠m:</p>
<table><thead><tr><th align="center">Tu·ª≥ ch·ªçn</th>
<th align="center">Tokenizer nhanh</th>
<th align="center">Tokenizer ch·∫≠m</th></tr></thead>
<tbody><tr><td align="center"><code>batched=True</code></td>
<td align="center">10.8s</td>
<td align="center">4min41s</td></tr>
<tr><td align="center"><code>batched=False</code></td>
<td align="center">59.2s</td>
<td align="center">5min3s</td></tr></tbody></table>
<p>ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† vi·ªác s·ª≠ d·ª•ng m·ªôt tokenizer nhanh v·ªõi t√πy ch·ªçn <code>batched=True</code> s·∫Ω nhanh h∆°n 30 l·∫ßn so v·ªõi phi√™n b·∫£n ch·∫≠m m√† kh√¥ng c√≥ l√¥ - ƒëi·ªÅu n√†y th·ª±c s·ª± tuy·ªát v·ªùi! ƒê√≥ l√† l√Ω do ch√≠nh t·∫°i sao tokenizer nhanh l√† m·∫∑c ƒë·ªãnh khi s·ª≠ d·ª•ng <code>AutoTokenizer</code> (v√† t·∫°i sao ch√∫ng ƒë∆∞·ª£c g·ªçi l√† ‚Äúnhanh‚Äù). Ch√∫ng c√≥ th·ªÉ ƒë·∫°t ƒë∆∞·ª£c t·ªëc ƒë·ªô nh∆∞ v·∫≠y b·ªüi v√¨ ph√≠a sau, ƒëo·∫°n m√£ token h√≥a ƒë∆∞·ª£c th·ª±c thi b·∫±ng Rust, ƒë√¢y l√† m·ªôt ng√¥n ng·ªØ gi√∫p d·ªÖ d√†ng th·ª±c hi·ªán ƒëo·∫°n m√£ song song.</p>
<p>Song song h√≥a c≈©ng l√† l√Ω do gi·∫£i th√≠ch cho t·ªëc ƒë·ªô tƒÉng g·∫ßn g·∫•p 6 l·∫ßn m√† tr√¨nh tokenize nhanh ƒë·∫°t ƒë∆∞·ª£c v·ªõi vi·ªác ph√¢n l√¥: b·∫°n kh√¥ng th·ªÉ song song m·ªôt thao t√°c tokenize ƒë∆°n l·∫ª, nh∆∞ng khi b·∫°n mu·ªën tokenize nhi·ªÅu vƒÉn b·∫£n c√πng m·ªôt l√∫c, b·∫°n c√≥ th·ªÉ ch·ªâ c·∫ßn chia nh·ªè vi·ªác th·ª±c thi tr√™n nhi·ªÅu quy tr√¨nh, m·ªói ng∆∞·ªùi ch·ªãu tr√°ch nhi·ªám v·ªÅ c√°c vƒÉn b·∫£n c·ªßa ri√™ng m√¨nh.</p>
<p><code>Dataset.map()</code> c≈©ng t·ª± c√≥ m·ªôt s·ªë kh·∫£ nƒÉng t√≠nh to√°n song song. V√¨ ch√∫ng kh√¥ng ƒë∆∞·ª£c h·ªó tr·ª£ b·ªüi Rust, n√™n ch√∫ng s·∫Ω kh√¥ng ƒë·ªÉ m·ªôt tr√¨nh tokenizer ch·∫≠m b·∫Øt k·ªãp v·ªõi m·ªôt tokenizer nhanh, nh∆∞ng ch√∫ng v·∫´n c√≥ th·ªÉ h·ªØu √≠ch (ƒë·∫∑c bi·ªát n·∫øu b·∫°n ƒëang s·ª≠ d·ª•ng m·ªôt tokenizer kh√¥ng c√≥ phi√™n b·∫£n nhanh). ƒê·ªÉ b·∫≠t x·ª≠ l√Ω ƒëa lu·ªìng, h√£y s·ª≠ d·ª•ng tham s·ªë <code>num_proc</code> v√† ch·ªâ ƒë·ªãnh s·ªë l∆∞·ª£ng quy tr√¨nh s·∫Ω s·ª≠ d·ª•ng trong l·ªánh g·ªçi c·ªßa b·∫°n t·ªõi <code>Dataset.map()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->slow_tokenizer = AutoTokenizer.from_pretrained(<span class="hljs-string">&quot;bert-base-cased&quot;</span>, use_fast=<span class="hljs-literal">False</span>)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">slow_tokenize_function</span>(<span class="hljs-params">examples</span>):
    <span class="hljs-keyword">return</span> slow_tokenizer(examples[<span class="hljs-string">&quot;review&quot;</span>], truncation=<span class="hljs-literal">True</span>)


tokenized_dataset = drug_dataset.<span class="hljs-built_in">map</span>(slow_tokenize_function, batched=<span class="hljs-literal">True</span>, num_proc=<span class="hljs-number">8</span>)<!-- HTML_TAG_END --></pre></div>
<p>B·∫°n c√≥ th·ªÉ th·ª≠ nghi·ªám m·ªôt ch√∫t v·ªõi th·ªùi gian ƒë·ªÉ x√°c ƒë·ªãnh s·ªë l∆∞·ª£ng quy tr√¨nh t·ªëi ∆∞u ƒë·ªÉ s·ª≠ d·ª•ng; trong tr∆∞·ªùng h·ª£p c·ªßa ch√∫ng ta, 8 d∆∞·ªùng nh∆∞ t·∫°o ra t·ªëc ƒë·ªô tƒÉng t·ªët nh·∫•t. D∆∞·ªõi ƒë√¢y l√† nh·ªØng con s·ªë ch√∫ng t√¥i nh·∫≠n ƒë∆∞·ª£c khi c√≥ v√† kh√¥ng c√≥ x·ª≠ l√Ω ƒëa lu·ªìng:</p>
<table><thead><tr><th align="center">Tu·ª≥ ch·ªçn</th>
<th align="center">Tokenizer nhanh</th>
<th align="center">Tokenizer ch·∫≠m</th></tr></thead>
<tbody><tr><td align="center"><code>batched=True</code></td>
<td align="center">10.8s</td>
<td align="center">4min41s</td></tr>
<tr><td align="center"><code>batched=False</code></td>
<td align="center">59.2s</td>
<td align="center">5min3s</td></tr>
<tr><td align="center"><code>batched=True</code>, <code>num_proc=8</code></td>
<td align="center">6.52s</td>
<td align="center">41.3s</td></tr>
<tr><td align="center"><code>batched=False</code>, <code>num_proc=8</code></td>
<td align="center">9.49s</td>
<td align="center">45.2s</td></tr></tbody></table>
<p>ƒê√≥ l√† nh·ªØng k·∫øt qu·∫£ h·ª£p l√Ω h∆°n nhi·ªÅu ƒë·ªëi v·ªõi tokenizer ch·∫≠m, nh∆∞ng hi·ªáu su·∫•t c·ªßa tokenizer nhanh c≈©ng ƒë√£ ƒë∆∞·ª£c c·∫£i thi·ªán ƒë√°ng k·ªÉ. Tuy nhi√™n, l∆∞u √Ω r·∫±ng ƒëi·ªÅu ƒë√≥ kh√¥ng ph·∫£i l√∫c n√†o c≈©ng ƒë√∫ng - ƒë·ªëi v·ªõi c√°c gi√° tr·ªã c·ªßa <code>num_proc</code> kh√°c 8, c√°c th·ª≠ nghi·ªám c·ªßa ch√∫ng t√¥i cho th·∫•y r·∫±ng s·ª≠ d·ª•ng <code>batched=True</code> m√† kh√¥ng c√≥ t√πy ch·ªçn n√†y s·∫Ω nhanh h∆°n. N√≥i chung, ch√∫ng t√¥i khuy√™n b·∫°n kh√¥ng n√™n s·ª≠ d·ª•ng x·ª≠ l√Ω ƒëa lu·ªìng Python cho c√°c tr√¨nh tokenize nhanh v·ªõi <code>batched=True</code>.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>S·ª≠ d·ª•ng <code>num_proc</code> ƒë·ªÉ tƒÉng t·ªëc qu√° tr√¨nh x·ª≠ l√Ω c·ªßa b·∫°n th∆∞·ªùng l√† m·ªôt √Ω t∆∞·ªüng tuy·ªát v·ªùi, mi·ªÖn l√† h√†m b·∫°n ƒëang s·ª≠ d·ª•ng ch∆∞a th·ª±c hi·ªán m·ªôt s·ªë ki·ªÉu x·ª≠ l√Ω ƒëa x·ª≠ l√Ω c·ªßa ri√™ng n√≥.</p></div>
<p>T·∫•t c·∫£ c√°c ch·ª©c nƒÉng n√†y ƒë∆∞·ª£c c√¥ ƒë·ªçng trong m·ªôt ph∆∞∆°ng ph√°p ƒë√£ kh√° tuy·ªát v·ªùi, nh∆∞ng c√≤n nhi·ªÅu h∆°n th·∫ø n·ªØa! V·ªõi <code>Dataset.map()</code> v√† <code>batched=True</code>, b·∫°n c√≥ th·ªÉ thay ƒë·ªïi s·ªë l∆∞·ª£ng ph·∫ßn t·ª≠ trong t·∫≠p d·ªØ li·ªáu c·ªßa m√¨nh. ƒêi·ªÅu n√†y c·ª±c k·ª≥ h·ªØu √≠ch trong nhi·ªÅu tr∆∞·ªùng h·ª£p m√† b·∫°n mu·ªën t·∫°o m·ªôt s·ªë ƒë·∫∑c tr∆∞ng hu·∫•n luy·ªán t·ª´ m·ªôt m·∫´u v√† ch√∫ng ta s·∫Ω c·∫ßn th·ª±c hi·ªán ƒëi·ªÅu n√†y nh∆∞ m·ªôt ph·∫ßn c·ªßa qu√° tr√¨nh ti·ªÅn x·ª≠ l√Ω cho m·ªôt s·ªë t√°c v·ª• NLP s·∫Ω th·ª±c hi·ªán trong <a href="/course/chapter7">Ch∆∞∆°ng 7</a>.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>üí° Trong h·ªçc m√°y, m·ªôt <em>m·∫´u</em> th∆∞·ªùng ƒë∆∞·ª£c ƒë·ªãnh nghƒ©a l√† t·∫≠p h·ª£p <em>ƒë·∫∑c tr∆∞ng</em> m√† ch√∫ng ta cung c·∫•p cho m√¥ h√¨nh. Trong m·ªôt s·ªë ng·ªØ c·∫£nh, c√°c ƒë·∫∑c tr∆∞ng n√†y s·∫Ω l√† t·∫≠p h·ª£p th√†nh c√°c c·ªôt trong <code>Dataset</code>, nh∆∞ng trong c√°c tr∆∞·ªùng h·ª£p kh√°c (nh∆∞ ·ªü ƒë√¢y v√† ƒë·ªÉ ph·ª•c v·ª• h·ªèi ƒë√°p), nhi·ªÅu ƒë·∫∑c tr∆∞ng c√≥ th·ªÉ ƒë∆∞·ª£c tr√≠ch xu·∫•t t·ª´ m·ªôt m·∫´u v√† thu·ªôc v·ªÅ m·ªôt c·ªôt duy nh·∫•t.</p></div>
<p>Ch√∫ng ta h√£y xem n√≥ ho·∫°t ƒë·ªông nh∆∞ th·∫ø n√†o! ·ªû ƒë√¢y, ta s·∫Ω tokenize c√°c m·∫´u c·ªßa m√¨nh v√† c·∫Øt ch√∫ng v·ªÅ ƒë·ªô d√†i t·ªëi ƒëa l√† 128, nh∆∞ng ta s·∫Ω y√™u c·∫ßu tr√¨nh tokenize tr·∫£ v·ªÅ <em>t·∫•t c·∫£</em> c√°c ƒëo·∫°n vƒÉn b·∫£n thay v√¨ ch·ªâ ƒëo·∫°n vƒÉn b·∫£n ƒë·∫ßu ti√™n. ƒêi·ªÅu n√†y c√≥ th·ªÉ ƒë∆∞·ª£c th·ª±c hi·ªán v·ªõi <code>return_overflowing_tokens=True</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize_and_split</span>(<span class="hljs-params">examples</span>):
    <span class="hljs-keyword">return</span> tokenizer(
        examples[<span class="hljs-string">&quot;review&quot;</span>],
        truncation=<span class="hljs-literal">True</span>,
        max_length=<span class="hljs-number">128</span>,
        return_overflowing_tokens=<span class="hljs-literal">True</span>,
    )<!-- HTML_TAG_END --></pre></div>
<p>H√£y ki·ªÉm tra ƒëi·ªÅu n√†y tr√™n m·ªôt m·∫´u tr∆∞·ªõc khi s·ª≠ d·ª•ng <code>Dataset.map()</code> tr√™n to√†n b·ªô t·∫≠p d·ªØ li·ªáu:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->result = tokenize_and_split(drug_dataset[<span class="hljs-string">&quot;train&quot;</span>][<span class="hljs-number">0</span>])
[<span class="hljs-built_in">len</span>(inp) <span class="hljs-keyword">for</span> inp <span class="hljs-keyword">in</span> result[<span class="hljs-string">&quot;input_ids&quot;</span>]]<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->[<span class="hljs-number">128</span>, <span class="hljs-number">49</span>]<!-- HTML_TAG_END --></pre></div>
<p>V√¨ v·∫≠y, m·∫´u ƒë·∫ßu ti√™n trong t·∫≠p hu·∫•n luy·ªán ƒë√£ tr·ªü th√†nh hai ƒë·∫∑c tr∆∞ng v√¨ n√≥ ƒë√£ ƒë∆∞·ª£c tokenize nhi·ªÅu h∆°n s·ªë l∆∞·ª£ng token t·ªëi ƒëa m√† ch√∫ng t√¥i ƒë√£ ch·ªâ ƒë·ªãnh: c√°i ƒë·∫ßu ti√™n c√≥ ƒë·ªô d√†i 128 v√† c√°i th·ª© hai c√≥ ƒë·ªô d√†i 49. B√¢y gi·ªù h√£y l√†m ƒëi·ªÅu n√†y cho t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ c·ªßa t·∫≠p d·ªØ li·ªáu!</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenized_dataset = drug_dataset.<span class="hljs-built_in">map</span>(tokenize_and_split, batched=<span class="hljs-literal">True</span>)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->ArrowInvalid: Column <span class="hljs-number">1</span> named condition expected length <span class="hljs-number">1463</span> but got length <span class="hljs-number">1000</span><!-- HTML_TAG_END --></pre></div>
<p>√îi kh√¥ng! N√≥ ƒë√£ kh√¥ng ho·∫°t ƒë·ªông! T·∫°i sao kh√¥ng? Nh√¨n v√†o th√¥ng b√°o l·ªói s·∫Ω cho ch√∫ng ta manh m·ªëi: c√≥ s·ª± kh√¥ng kh·ªõp v·ªÅ ƒë·ªô d√†i c·ªßa m·ªôt trong c√°c c·ªôt, m·ªôt c·ªôt c√≥ ƒë·ªô d√†i 1,463 v√† c·ªôt c√≤n l·∫°i c√≥ ƒë·ªô d√†i 1,000. N·∫øu b·∫°n ƒë√£ xem <a href="https://huggingface.co/docs/datasets/package_reference/main_classes.html#datasets.Dataset.map" rel="nofollow">t√†i li·ªáu</a> v·ªÅ <code>Dataset.map()</code>, b·∫°n c√≥ th·ªÉ nh·ªõ r·∫±ng ƒë√≥ l√† s·ªë c√°c m·∫´u ƒë∆∞·ª£c truy·ªÅn v√†o h√†m m√† ch√∫ng ta ƒëang √°nh x·∫°; ·ªü ƒë√¢y 1,000 m·∫´u ƒë√≥ ƒë√£ cung c·∫•p 1,463 ƒë·∫∑c tr∆∞ng m·ªõi, d·∫´n ƒë·∫øn l·ªói h√¨nh d·∫°ng.</p>
<p>V·∫•n ƒë·ªÅ l√† ch√∫ng ta ƒëang c·ªë g·∫Øng k·∫øt h·ª£p hai t·∫≠p d·ªØ li·ªáu kh√°c nhau v·ªõi c√°c k√≠ch th∆∞·ªõc kh√°c nhau: c·ªôt <code>drug_dataset</code> s·∫Ω c√≥ m·ªôt s·ªë m·∫´u nh·∫•t ƒë·ªãnh (l·ªói ph√≠a ch√∫ng ta l√† 1,000), nh∆∞ng <code>tokenized_dataset</code>  m√† ch√∫ng ta ƒëang x√¢y d·ª±ng s·∫Ω c√≥ nhi·ªÅu h∆°n (1,463 trong th√¥ng b√°o l·ªói). ƒêi·ªÅu n√†y kh√¥ng ho·∫°t ƒë·ªông ƒë·ªëi v·ªõi <code>Dataset</code>, v√¨ v·∫≠y ch√∫ng ta c·∫ßn x√≥a c√°c c·ªôt kh·ªèi t·∫≠p d·ªØ li·ªáu c≈© ho·∫∑c l√†m cho ch√∫ng c√≥ c√πng k√≠ch th∆∞·ªõc v·ªõi ch√∫ng trong t·∫≠p d·ªØ li·ªáu m·ªõi. Ch√∫ng ta c√≥ th·ªÉ th·ª±c hi·ªán ƒëi·ªÅu ƒë·∫ßu th√¥ng qua tham s·ªë <code>remove_columns</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenized_dataset = drug_dataset.<span class="hljs-built_in">map</span>(
    tokenize_and_split, batched=<span class="hljs-literal">True</span>, remove_columns=drug_dataset[<span class="hljs-string">&quot;train&quot;</span>].column_names
)<!-- HTML_TAG_END --></pre></div>
<p>B√¢y gi·ªù n√≥ ho·∫°t ƒë·ªông m√† kh√¥ng c√≥ l·ªói. Ch√∫ng ta c√≥ th·ªÉ ki·ªÉm tra xem t·∫≠p d·ªØ li·ªáu m·ªõi c·ªßa m√¨nh c√≥ nhi·ªÅu ph·∫ßn t·ª≠ h∆°n t·∫≠p d·ªØ li·ªáu g·ªëc hay kh√¥ng b·∫±ng c√°ch so s√°nh ƒë·ªô d√†i:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-built_in">len</span>(tokenized_dataset[<span class="hljs-string">&quot;train&quot;</span>]), <span class="hljs-built_in">len</span>(drug_dataset[<span class="hljs-string">&quot;train&quot;</span>])<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->(<span class="hljs-number">206772</span>, <span class="hljs-number">138514</span>)<!-- HTML_TAG_END --></pre></div>
<p>Ch√∫ng t√¥i ƒë√£ ƒë·ªÅ c·∫≠p r·∫±ng ch√∫ng ta c≈©ng c√≥ th·ªÉ gi·∫£i quy·∫øt v·∫•n ƒë·ªÅ chi·ªÅu d√†i kh√¥ng kh·ªõp b·∫±ng c√°ch l√†m cho c√°c c·ªôt c≈© c√≥ c√πng k√≠ch th∆∞·ªõc v·ªõi c√°c c·ªôt m·ªõi. ƒê·ªÉ th·ª±c hi·ªán vi·ªác n√†y, ch√∫ng ta s·∫Ω c·∫ßn tr∆∞·ªùng <code>overflow_to_sample_mapping</code> m√† tokenizer tr·∫£ v·ªÅ khi ch√∫ng ta ƒë·∫∑t <code>return_overflowing_tokens=True</code>. N√≥ cung c·∫•p cho ch√∫ng ta m·ªôt √°nh x·∫° t·ª´ m·ªôt ch·ªâ m·ª•c ƒë·∫∑c tr∆∞ng m·ªõi ƒë·∫øn ch·ªâ m·ª•c c·ªßa m·∫´u m√† n√≥ b·∫Øt ngu·ªìn t·ª´ ƒë√≥. S·ª≠ d·ª•ng ƒëi·ªÅu n√†y, ch√∫ng ta c√≥ th·ªÉ li√™n k·∫øt m·ªói kh√≥a c√≥ trong t·∫≠p d·ªØ li·ªáu ban ƒë·∫ßu v·ªõi m·ªôt danh s√°ch c√°c gi√° tr·ªã c√≥ k√≠ch th∆∞·ªõc ph√π h·ª£p b·∫±ng c√°ch l·∫∑p l·∫°i c√°c gi√° tr·ªã c·ªßa m·ªói v√≠ d·ª• nhi·ªÅu l·∫ßn khi n√≥ t·∫°o ra c√°c ƒë·∫∑c tr∆∞ng m·ªõi:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize_and_split</span>(<span class="hljs-params">examples</span>):
    result = tokenizer(
        examples[<span class="hljs-string">&quot;review&quot;</span>],
        truncation=<span class="hljs-literal">True</span>,
        max_length=<span class="hljs-number">128</span>,
        return_overflowing_tokens=<span class="hljs-literal">True</span>,
    )
    <span class="hljs-comment"># Extract mapping between new and old indices</span>
    sample_map = result.pop(<span class="hljs-string">&quot;overflow_to_sample_mapping&quot;</span>)
    <span class="hljs-keyword">for</span> key, values <span class="hljs-keyword">in</span> examples.items():
        result[key] = [values[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> sample_map]
    <span class="hljs-keyword">return</span> result<!-- HTML_TAG_END --></pre></div>
<p>Ch√∫ng ta c√≥ th·ªÉ th·∫•y n√≥ ho·∫°t ƒë·ªông v·ªõi <code>Dataset.map()</code> m√† ch√∫ng ta kh√¥ng c·∫ßn x√≥a c√°c c·ªôt c≈©:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->tokenized_dataset = drug_dataset.<span class="hljs-built_in">map</span>(tokenize_and_split, batched=<span class="hljs-literal">True</span>)
tokenized_dataset<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>, <span class="hljs-string">&#x27;token_type_ids&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>],
        num_rows: <span class="hljs-number">206772</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;attention_mask&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;input_ids&#x27;</span>, <span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>, <span class="hljs-string">&#x27;token_type_ids&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>],
        num_rows: <span class="hljs-number">68876</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>Ch√∫ng ta nh·∫≠n ƒë∆∞·ª£c c√πng s·ªë ƒë·∫∑c tr∆∞ng hu·∫•n luy·ªán nh∆∞ tr∆∞·ªõc ƒë√≥, nh∆∞ng ·ªü ƒë√¢y ta ƒë√£ gi·ªØ l·∫°i t·∫•t c·∫£ c√°c tr∆∞·ªùng c≈©. N·∫øu b·∫°n c·∫ßn ch√∫ng ƒë·ªÉ h·∫≠u x·ª≠ l√Ω sau khi √°p d·ª•ng m√¥ h√¨nh c·ªßa m√¨nh, b·∫°n c√≥ th·ªÉ mu·ªën s·ª≠ d·ª•ng ph∆∞∆°ng ph√°p n√†y.</p>
<p>B√¢y gi·ªù b·∫°n ƒë√£ th·∫•y c√°ch ü§ó Datasets c√≥ th·ªÉ ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ ti·ªÅn x·ª≠ l√Ω m·ªôt t·∫≠p d·ªØ li·ªáu theo nhi·ªÅu c√°ch kh√°c nhau. M·∫∑c d√π c√°c ch·ª©c nƒÉng x·ª≠ l√Ω c·ªßa ü§ó Datasets s·∫Ω ƒë√°p ·ª©ng h·∫ßu h·∫øt c√°c nhu c·∫ßu hu·∫•n luy·ªán m√¥ h√¨nh c·ªßa b·∫°n,
c√≥ th·ªÉ ƒë√¥i khi b·∫°n c·∫ßn chuy·ªÉn sang Pandas ƒë·ªÉ truy c·∫≠p c√°c t√≠nh nƒÉng m·∫°nh m·∫Ω h∆°n, ch·∫≥ng h·∫°n nh∆∞  <code>DataFrame.groupby()</code> ho·∫∑c c√°c API c·∫•p cao ƒë·ªÉ tr·ª±c quan h√≥a. May m·∫Øn thay, ü§ó Datasets ƒë∆∞·ª£c thi·∫øt k·∫ø ƒë·ªÉ c√≥ th·ªÉ t∆∞∆°ng t√°c v·ªõi c√°c th∆∞ vi·ªán nh∆∞ Pandas, NumPy, PyTorch, TensorFlow v√† JAX. Ch√∫ng ta h√£y xem c√°ch n√†y ho·∫°t ƒë·ªông nh∆∞ th·∫ø n√†o.</p>
<h2 class="relative group"><a id="t-dataset-ti-dataframe-v-ngc-li" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#t-dataset-ti-dataframe-v-ngc-li"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>T·ª´ <code>Dataset</code> t·ªõi <code>DataFrame</code> v√† ng∆∞·ª£c l·∫°i
	</span></h2>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/tfcY1067A5Q" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>ƒê·ªÉ cho ph√©p chuy·ªÉn ƒë·ªïi gi·ªØa c√°c th∆∞ vi·ªán b√™n th·ª© ba kh√°c nhau, ü§ó Datasets cung c·∫•p h√†m <code>Dataset.set_format()</code>. H√†m n√†y ch·ªâ thay ƒë·ªïi <em>ƒë·ªãnh d·∫°ng ƒë·∫ßu ra</em> c·ªßa t·∫≠p d·ªØ li·ªáu, v√¨ v·∫≠y b·∫°n c√≥ th·ªÉ d·ªÖ d√†ng chuy·ªÉn sang ƒë·ªãnh d·∫°ng kh√°c m√† kh√¥ng ·∫£nh h∆∞·ªüng ƒë·∫øn <em>ƒë·ªãnh d·∫°ng ƒë·∫ßu ra</em> b√™n d∆∞·ªõi, ƒë√≥ l√† Apache Arrow. Vi·ªác ƒë·ªãnh d·∫°ng ƒë∆∞·ª£c th·ª±c hi·ªán t·∫°i ch·ªó. ƒê·ªÉ ch·ª©ng minh, h√£y chuy·ªÉn ƒë·ªïi t·∫≠p d·ªØ li·ªáu c·ªßa ch√∫ng t√¥i th√†nh Pandas:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset.set_format(<span class="hljs-string">&quot;pandas&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>Gi·ªù khi ch√∫ng ta truy c·∫≠p c√°c ph·∫ßn t·ª≠ c·ªßa t·∫≠p d·ªØ li·ªáu, ta nh·∫≠n ƒë∆∞·ª£c <code>pandas.DataFrame</code> thay v√¨ t·ª´ ƒëi·ªÉn:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset[<span class="hljs-string">&quot;train&quot;</span>][:<span class="hljs-number">3</span>]<!-- HTML_TAG_END --></pre></div>
<table border="1" class="dataframe"><thead><tr style="text-align: right;"><th></th>
      <th>patient_id</th>
      <th>drugName</th>
      <th>condition</th>
      <th>review</th>
      <th>rating</th>
      <th>date</th>
      <th>usefulCount</th>
      <th>review_length</th></tr></thead>
  <tbody><tr><th>0</th>
      <td>95260</td>
      <td>Guanfacine</td>
      <td>adhd</td>
      <td>&quot;My son is halfway through his fourth week of Intuniv...&quot;</td>
      <td>8.0</td>
      <td>April 27, 2010</td>
      <td>192</td>
      <td>141</td></tr>
    <tr><th>1</th>
      <td>92703</td>
      <td>Lybrel</td>
      <td>birth control</td>
      <td>&quot;I used to take another oral contraceptive, which had 21 pill cycle, and was very happy- very light periods, max 5 days, no other side effects...&quot;</td>
      <td>5.0</td>
      <td>December 14, 2009</td>
      <td>17</td>
      <td>134</td></tr>
    <tr><th>2</th>
      <td>138000</td>
      <td>Ortho Evra</td>
      <td>birth control</td>
      <td>&quot;This is my first time using any form of birth control...&quot;</td>
      <td>8.0</td>
      <td>November 3, 2015</td>
      <td>10</td>
      <td>89</td></tr></tbody></table>
<p>H√£y t·∫°o ra m·ªôt <code>pandas.DataFrame</code> cho to√†n b·ªô t·∫≠p hu·∫•n luy·ªán b·∫±ng c√°ch ch·ªçn t·∫•t c·∫£ c√°c ph·∫ßn t·ª≠ trong <code>drug_dataset[&quot;train&quot;]</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->train_df = drug_dataset[<span class="hljs-string">&quot;train&quot;</span>][:]<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>üö® B√™n d∆∞·ªõi <code>Dataset.set_format()</code> thay ƒë·ªïi ƒë·ªãnh d·∫°ng tr·∫£ v·ªÅ cho ph∆∞∆°ng th·ª©c <code>__getitem __()</code> c·ªßa t·∫≠p d·ªØ li·ªáu. ƒêi·ªÅu n√†y c√≥ nghƒ©a l√† khi ch√∫ng ta mu·ªën t·∫°o m·ªôt ƒë·ªëi t∆∞·ª£ng m·ªõi nh∆∞ <code>train_df</code> t·ª´ <code>Dataset</code> ·ªü ƒë·ªãnh d·∫°ng <code>&quot;pandas&quot;</code>, ch√∫ng ta c·∫ßn c·∫Øt to√†n b·ªô t·∫≠p d·ªØ li·ªáu ƒë·ªÉ c√≥ ƒë∆∞·ª£c m·ªôt <code>pandas.DataFrame</code>. B·∫°n c√≥ th·ªÉ t·ª± x√°c minh xem ki·ªÉu d·ªØ li·ªáu c·ªßa <code>drug_dataset[&quot;train&quot;]</code> c√≥ ph·∫£i l√† <code>Dataset</code>, b·∫•t k·ªÉ ƒë·ªãnh d·∫°ng ƒë·∫ßu ra l√† g√¨.</p></div>
<p>T·ª´ ƒë√¢y, ta c√≥ th·ªÉ s·ª≠ d·ª•ng t·∫•t c·∫£ c√°c ch·ª©c nƒÉng c·ªßa Pandas m√† ta mu·ªën. V√≠ d·ª•, ch√∫ng ta c√≥ th·ªÉ th·ª±c hi·ªán chu·ªói l·∫° m·∫Øt ƒë·ªÉ t√≠nh to√°n ph√¢n ph·ªëi l·ªõp gi·ªØa c√°c <code>condition</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->frequencies = (
    train_df[<span class="hljs-string">&quot;condition&quot;</span>]
    .value_counts()
    .to_frame()
    .reset_index()
    .rename(columns={<span class="hljs-string">&quot;index&quot;</span>: <span class="hljs-string">&quot;condition&quot;</span>, <span class="hljs-string">&quot;condition&quot;</span>: <span class="hljs-string">&quot;frequency&quot;</span>})
)
frequencies.head()<!-- HTML_TAG_END --></pre></div>
<table border="1" class="dataframe"><thead><tr style="text-align: right;"><th></th>
      <th>condition</th>
      <th>frequency</th></tr></thead>
  <tbody><tr><th>0</th>
      <td>birth control</td>
      <td>27655</td></tr>
    <tr><th>1</th>
      <td>depression</td>
      <td>8023</td></tr>
    <tr><th>2</th>
      <td>acne</td>
      <td>5209</td></tr>
    <tr><th>3</th>
      <td>anxiety</td>
      <td>4991</td></tr>
    <tr><th>4</th>
      <td>pain</td>
      <td>4744</td></tr></tbody></table>
<p>V√† khi ch√∫ng ta ho√†n th√†nh ph√¢n t√≠ch Pandas c·ªßa m√¨nh, ch√∫ng ta lu√¥n c√≥ th·ªÉ t·∫°o m·ªôt ƒë·ªëi t∆∞·ª£ng <code>Dataset</code> m·ªõi b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m <code>Dataset.from_pandas()</code> nh∆∞ sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> Dataset

freq_dataset = Dataset.from_pandas(frequencies)
freq_dataset<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->Dataset({
    features: [<span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;frequency&#x27;</span>],
    num_rows: <span class="hljs-number">819</span>
})<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>‚úèÔ∏è <strong>Th·ª≠ nghi·ªám th√¥i!</strong> T√≠nh x·∫øp h·∫°ng trung b√¨nh cho m·ªói lo·∫°i thu·ªëc v√† l∆∞u tr·ªØ k·∫øt qu·∫£ ·ªü d·∫°ng <code>Dataset</code> m·ªõi.</p></div>
<p>Ph·∫ßn n√†y k·∫øt th√∫c chuy·∫øn tham quan c·ªßa ch√∫ng ta v·ªÅ c√°c k·ªπ thu·∫≠t ti·ªÅn x·ª≠ l√Ω kh√°c nhau c√≥ s·∫µn trong ü§ó Datasets. ƒê·ªÉ ho√†n thi·ªán ph·∫ßn n√†y, h√£y t·∫°o m·ªôt t·ªáp ki·ªÉm ƒë·ªãnh ƒë·ªÉ chu·∫©n b·ªã t·∫≠p d·ªØ li·ªáu cho vi·ªác hu·∫•n luy·ªán m·ªôt tr√¨nh ph√¢n lo·∫°i. Tr∆∞·ªõc khi l√†m nh∆∞ v·∫≠y, ch√∫ng ta s·∫Ω ƒë·∫∑t l·∫°i ƒë·ªãnh d·∫°ng ƒë·∫ßu ra c·ªßa <code>drug_dataset</code> t·ª´ <code>&quot;pandas&quot;</code> th√†nh <code>&quot;arrow&quot;</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset.reset_format()<!-- HTML_TAG_END --></pre></div>
<h2 class="relative group"><a id="to-ra-mt-tp-kim-nh" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#to-ra-mt-tp-kim-nh"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>T·∫°o ra m·ªôt t·ªáp ki·ªÉm ƒë·ªãnh
	</span></h2>

<p>M·∫∑c d√π ch√∫ng ta c√≥ m·ªôt b·ªô d·ªØ li·ªáu ki·ªÉm th·ª≠ c√≥ th·ªÉ s·ª≠ d·ª•ng ƒë·ªÉ ƒë√°nh gi√°, nh∆∞ng b·∫°n n√™n gi·ªØ nguy√™n b·ªô ki·ªÉm th·ª≠ v√† t·∫°o m·ªôt b·ªô ki·ªÉm ƒë·ªãnh ri√™ng trong qu√° tr√¨nh ph√°t tri·ªÉn. Khi b·∫°n h√†i l√≤ng v·ªõi hi·ªáu su·∫•t c·ªßa c√°c m√¥ h√¨nh c·ªßa m√¨nh tr√™n b·ªô ki·ªÉm ƒë·ªãnh, b·∫°n c√≥ th·ªÉ th·ª±c hi·ªán ki·ªÉm tra l·∫ßn cu·ªëi ƒë·ªëi v·ªõi b·ªô ki·ªÉm th·ª≠. Quy tr√¨nh n√†y gi√∫p gi·∫£m thi·ªÉu r·ªßi ro r·∫±ng b·∫°n s·∫Ω trang b·ªã qu√° m·ª©c cho b·ªô ki·ªÉm th·ª≠ v√† tri·ªÉn khai m·ªôt m√¥ h√¨nh kh√¥ng th√†nh c√¥ng tr√™n d·ªØ li·ªáu trong th·∫ø gi·ªõi th·ª±c.</p>
<p>ü§ó Datasets cung c·∫•p m·ªôt h√†m <code>Dataset.train_test_split()</code> d·ª±a tr√™n t√≠nh nƒÉng n·ªïi ti·∫øng t·ª´ <code>scikit-learn</code>. H√£y c√πng d√πng n√≥ ƒë·ªÉ chia t·∫≠p hu·∫•n luy·ªán th√†nh c√°c t·∫≠p <code>train</code> v√† <code>validation</code> (ta ƒë·∫∑t tham s·ªë <code>seed</code> cho m·ª•c ƒë√≠nh t√°i t·∫°o):</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset_clean = drug_dataset[<span class="hljs-string">&quot;train&quot;</span>].train_test_split(train_size=<span class="hljs-number">0.8</span>, seed=<span class="hljs-number">42</span>)
<span class="hljs-comment"># Thay ƒë·ªïi t√™n m·∫∑c ƒë·ªãnh &quot;test&quot; th√†nh &quot;validation&quot;</span>
drug_dataset_clean[<span class="hljs-string">&quot;validation&quot;</span>] = drug_dataset_clean.pop(<span class="hljs-string">&quot;test&quot;</span>)
<span class="hljs-comment"># Th√™m &quot;test&quot; v√†o `DatasetDict`</span>
drug_dataset_clean[<span class="hljs-string">&quot;test&quot;</span>] = drug_dataset[<span class="hljs-string">&quot;test&quot;</span>]
drug_dataset_clean<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>, <span class="hljs-string">&#x27;review_clean&#x27;</span>],
        num_rows: <span class="hljs-number">110811</span>
    })
    validation: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>, <span class="hljs-string">&#x27;review_clean&#x27;</span>],
        num_rows: <span class="hljs-number">27703</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>, <span class="hljs-string">&#x27;review_clean&#x27;</span>],
        num_rows: <span class="hljs-number">46108</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>Tuy·ªát v·ªùi, ta hi·ªán ƒë√£ chu·∫©n b·ªã m·ªôt t·∫≠p d·ªØ li·ªáu s·∫µn s√†ng ƒë·ªÉ hu·∫•n luy·ªán m·ªôt s·ªë m√¥ h√¨nh! Trong <a href="/course/chapter5/5">ph·∫ßn 5</a>, ch√∫ng t√¥i s·∫Ω ch·ªâ cho b·∫°n c√°ch t·∫£i t·∫≠p d·ªØ li·ªáu l√™n Hugging Face Hub, nh∆∞ng b√¢y gi·ªù h√£y quen v·ªõi ph√¢n t√≠ch c·ªßa ch√∫ng t√¥i b·∫±ng c√°ch xem x√©t m·ªôt s·ªë c√°ch b·∫°n c√≥ th·ªÉ l∆∞u t·∫≠p d·ªØ li·ªáu tr√™n m√°y c·ª•c b·ªô c·ªßa m√¨nh.</p>
<h2 class="relative group"><a id="lu-mt-b-d-liu" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#lu-mt-b-d-liu"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>L∆∞u m·ªôt b·ªô d·ªØ li·ªáu
	</span></h2>

<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/blF9uxYcKHo" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>M·∫∑c d√π ü§ó Datasets s·∫Ω l∆∞u v√†o b·ªô nh·ªõ cache m·ªçi t·∫≠p d·ªØ li·ªáu ƒë√£ t·∫£i xu·ªëng v√† c√°c ho·∫°t ƒë·ªông ƒë∆∞·ª£c th·ª±c hi·ªán tr√™n n√≥, nh∆∞ng ƒë√¥i khi b·∫°n s·∫Ω mu·ªën l∆∞u t·∫≠p d·ªØ li·ªáu v√†o ƒëƒ©a (v√≠ d·ª•: trong tr∆∞·ªùng h·ª£p b·ªô nh·ªõ cache b·ªã x√≥a). Nh∆∞ th·ªÉ hi·ªán trong b·∫£ng b√™n d∆∞·ªõi, ü§ó Datasets cung c·∫•p ba ch·ª©c nƒÉng ch√≠nh ƒë·ªÉ l∆∞u t·∫≠p d·ªØ li·ªáu c·ªßa b·∫°n ·ªü c√°c ƒë·ªãnh d·∫°ng kh√°c nhau:</p>
<table><thead><tr><th align="center">ƒê·ªãnh d·∫°ng d·ªØ li·ªáu</th>
<th align="center">H√†m</th></tr></thead>
<tbody><tr><td align="center">Arrow</td>
<td align="center"><code>Dataset.save_to_disk()</code></td></tr>
<tr><td align="center">CSV</td>
<td align="center"><code>Dataset.to_csv()</code></td></tr>
<tr><td align="center">JSON</td>
<td align="center"><code>Dataset.to_json()</code></td></tr></tbody></table>
<p>V√≠ d·ª•, h√£y c√πng l∆∞u d·ªØ li·ªáu s·∫°ch c·ªßa ch√∫ng ta v·ªÅ ƒë·ªãnh d·∫°ng Arrow:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug_dataset_clean.save_to_disk(<span class="hljs-string">&quot;drug-reviews&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>N√≥ s·∫Ω t·∫°o ra m·ªôt kho l∆∞u tr·ªØ v·ªõi c·∫•u tr√∫c nh∆∞ sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->drug-reviews/
‚îú‚îÄ‚îÄ dataset_dict.json
‚îú‚îÄ‚îÄ test
‚îÇ   ‚îú‚îÄ‚îÄ dataset.arrow
‚îÇ   ‚îú‚îÄ‚îÄ dataset_info.json
‚îÇ   ‚îî‚îÄ‚îÄ <span class="hljs-keyword">state</span>.json
‚îú‚îÄ‚îÄ train
‚îÇ   ‚îú‚îÄ‚îÄ dataset.arrow
‚îÇ   ‚îú‚îÄ‚îÄ dataset_info.json
‚îÇ   ‚îú‚îÄ‚îÄ indices.arrow
‚îÇ   ‚îî‚îÄ‚îÄ <span class="hljs-keyword">state</span>.json
‚îî‚îÄ‚îÄ validation
    ‚îú‚îÄ‚îÄ dataset.arrow
    ‚îú‚îÄ‚îÄ dataset_info.json
    ‚îú‚îÄ‚îÄ indices.arrow
    ‚îî‚îÄ‚îÄ <span class="hljs-keyword">state</span>.json<!-- HTML_TAG_END --></pre></div>
<p>n∆°i ch√∫ng ta c√≥ th·ªÉ th·∫•y r·∫±ng m·ªói ph·∫ßn t√°ch ra ƒë∆∞·ª£c li√™n k·∫øt v·ªõi b·∫£ng <em>dataset.arrow</em> c·ªßa ri√™ng n√≥ v√† m·ªôt s·ªë si√™u d·ªØ li·ªáu trong <em>dataset_info.json</em> v√† <em>state.json</em>. B·∫°n c√≥ th·ªÉ coi ƒë·ªãnh d·∫°ng Arrow nh∆∞ m·ªôt b·∫£ng g·ªìm c√°c c·ªôt v√† h√†ng ∆∞a th√≠ch ƒë∆∞·ª£c t·ªëi ∆∞u h√≥a ƒë·ªÉ x√¢y d·ª±ng c√°c ·ª©ng d·ª•ng hi·ªáu su·∫•t cao x·ª≠ l√Ω v√† v·∫≠n chuy·ªÉn c√°c t·∫≠p d·ªØ li·ªáu l·ªõn.</p>
<p>Sau khi t·∫≠p d·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u, ch√∫ng ta c√≥ th·ªÉ t·∫£i n√≥ b·∫±ng c√°ch s·ª≠ d·ª•ng h√†m <code>load_from_disk()</code> nh∆∞ sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_from_disk

drug_dataset_reloaded = load_from_disk(<span class="hljs-string">&quot;drug-reviews&quot;</span>)
drug_dataset_reloaded<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->DatasetDict({
    train: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>],
        num_rows: <span class="hljs-number">110811</span>
    })
    validation: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>],
        num_rows: <span class="hljs-number">27703</span>
    })
    test: Dataset({
        features: [<span class="hljs-string">&#x27;patient_id&#x27;</span>, <span class="hljs-string">&#x27;drugName&#x27;</span>, <span class="hljs-string">&#x27;condition&#x27;</span>, <span class="hljs-string">&#x27;review&#x27;</span>, <span class="hljs-string">&#x27;rating&#x27;</span>, <span class="hljs-string">&#x27;date&#x27;</span>, <span class="hljs-string">&#x27;usefulCount&#x27;</span>, <span class="hljs-string">&#x27;review_length&#x27;</span>],
        num_rows: <span class="hljs-number">46108</span>
    })
})<!-- HTML_TAG_END --></pre></div>
<p>ƒê·ªëi v·ªõi ƒë·ªãnh d·∫°ng CSV v√† JSON, ch√∫ng ta ph·∫£i l∆∞u tr·ªØ t·ª´ng ph·∫ßn th√†nh m·ªôt t·ªáp ri√™ng bi·ªát. M·ªôt c√°ch ƒë·ªÉ l√†m ƒëi·ªÅu n√†y l√† l·∫∑p l·∫°i c√°c kh√≥a v√† gi√° tr·ªã trong ƒë·ªëi t∆∞·ª£ng <code>DatasetDict</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">for</span> split, dataset <span class="hljs-keyword">in</span> drug_dataset_clean.items():
    dataset.to_json(<span class="hljs-string">f&quot;drug-reviews-<span class="hljs-subst">{split}</span>.jsonl&quot;</span>)<!-- HTML_TAG_END --></pre></div>
<p>N√≥ s·∫Ω l∆∞u m·ªói ph·∫ßn d·ªØ li·ªáu v√†o<a href="https://jsonlines.org" rel="nofollow">ƒë·ªãnh d·∫°ng JSON Lines</a>, n∆°i m·ªói d√≤ng trong b·ªô d·ªØ li·ªáu ƒë∆∞·ª£c l∆∞u tr·ªØ tr√™n m·ªôt d√≤ng JSON. ƒê√¢y l√† m·ªôt v√≠ d·ª• v·ªÅ h√¨nh h√†i cua n√≥:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->!head -n <span class="hljs-number">1</span> drug-reviews-train.jsonl<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&quot;patient_id&quot;</span>:<span class="hljs-number">141780</span>,<span class="hljs-string">&quot;drugName&quot;</span>:<span class="hljs-string">&quot;Escitalopram&quot;</span>,<span class="hljs-string">&quot;condition&quot;</span>:<span class="hljs-string">&quot;depression&quot;</span>,<span class="hljs-string">&quot;review&quot;</span>:<span class="hljs-string">&quot;\&quot;I seemed to experience the regular side effects of LEXAPRO, insomnia, low sex drive, sleepiness during the day. I am taking it at night because my doctor said if it made me tired to take it at night. I assumed it would and started out taking it at night. Strange dreams, some pleasant. I was diagnosed with fibromyalgia. Seems to be helping with the pain. Have had anxiety and depression in my family, and have tried quite a few other medications that haven&#x27;t worked. Only have been on it for two weeks but feel more positive in my mind, want to accomplish more in my life. Hopefully the side effects will dwindle away, worth it to stick with it from hearing others responses. Great medication.\&quot;&quot;</span>,<span class="hljs-string">&quot;rating&quot;</span>:<span class="hljs-number">9.0</span>,<span class="hljs-string">&quot;date&quot;</span>:<span class="hljs-string">&quot;May 29, 2011&quot;</span>,<span class="hljs-string">&quot;usefulCount&quot;</span>:<span class="hljs-number">10</span>,<span class="hljs-string">&quot;review_length&quot;</span>:<span class="hljs-number">125</span>}<!-- HTML_TAG_END --></pre></div>
<p>Ch√∫ng ta sau ƒë√≥ c√≥ th·ªÉ s·ª≠ d·ª•ng c√°c k·ªπ thu·∫≠t trong <a href="/course/chapter5/2">ph·∫ßn 2</a> ƒë·ªÉ t·∫£i t·ªáp JSON nh∆∞ sau:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->data_files = {
    <span class="hljs-string">&quot;train&quot;</span>: <span class="hljs-string">&quot;drug-reviews-train.jsonl&quot;</span>,
    <span class="hljs-string">&quot;validation&quot;</span>: <span class="hljs-string">&quot;drug-reviews-validation.jsonl&quot;</span>,
    <span class="hljs-string">&quot;test&quot;</span>: <span class="hljs-string">&quot;drug-reviews-test.jsonl&quot;</span>,
}
drug_dataset_reloaded = load_dataset(<span class="hljs-string">&quot;json&quot;</span>, data_files=data_files)<!-- HTML_TAG_END --></pre></div>
<p>V√† ƒë√≥ l√† n√≥ cho chuy·∫øn du ngo·∫°n c·ªßa ch√∫ng ta v·ªõi s·∫Øp x·∫øp d·ªØ li·ªáu s·ª≠ d·ª•ng ü§ó Datasets! Gi·ªù ta ƒë√£ c√≥ m·ªôt t·∫≠p d·ªØ li·ªáu ƒë√£ ƒë∆∞·ª£c l√†m s·∫°ch ƒë·ªÉ hu·∫•n luy·ªán m√¥ h√¨nh, ƒë√¢y l√† m·ªôt v√†i √Ω t∆∞·ªüng m√† b·∫°n c√≥ th·ªÉ th·ª≠:</p>
<ol><li>S·ª≠ d·ª•ng c√°c k·ªπ thu·∫≠t t·ª´ <a href="/course/chapter3">Ch∆∞∆°ng 3</a> ƒë·ªÉ hu·∫•n luy·ªán m·ªôt b·ªô ph√¢n lo·∫°i c√≥ th·ªÉ d·ª± ƒëo√°n t√¨nh tr·∫°ng b·ªánh nh√¢n d·ª±a tr√™n c√°c ph·∫£n h·ªìi v·ªÅ thu·ªëc.</li>
<li>S·ª≠ d·ª•ng pipeline <code>summarization</code> t·ª´ <a href="/course/chapter1">Ch∆∞∆°ng 1</a> ƒë·ªÉ t·∫°o c√°c b·∫£n t√≥m t·∫Øt c√°c b√†i ƒë√°nh gi√°.</li></ol>
<p>Ti·∫øp theo, ch√∫ng ta s·∫Ω xem x√©t c√°ch ü§ó Datasets c√≥ th·ªÉ cho ph√©p b·∫°n l√†m vi·ªác v·ªõi nh·ªØng t·∫≠p d·ªØ li·ªáu kh·ªïng l·ªì m√† kh√¥ng l√†m h·ªèng m√°y t√≠nh x√°ch tay c·ªßa b·∫°n!</p>


		<script type="module" data-hydrate="4jbawg">
		import { start } from "/docs/course/pr_298/vi/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="4jbawg"]').parentNode,
			paths: {"base":"/docs/course/pr_298/vi","assets":"/docs/course/pr_298/vi"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/pr_298/vi/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/pr_298/vi/_app/pages/chapter5/3.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
