<meta charset="utf-8" /><meta http-equiv="content-security-policy" content=""><meta name="hf:doc:metadata" content="{&quot;local&quot;:&quot;tinh-chnh-mt-m-hnh-vi-trainer-api&quot;,&quot;sections&quot;:[{&quot;local&quot;:&quot;hun-luyn&quot;,&quot;title&quot;:&quot;Hu·∫•n luy·ªán&quot;},{&quot;local&quot;:&quot;nh-gi&quot;,&quot;title&quot;:&quot;ƒê√°nh gi√°&quot;}],&quot;title&quot;:&quot;Tinh ch·ªânh m·ªôt m√¥ h√¨nh v·ªõi Trainer API&quot;}" data-svelte="svelte-1phssyn">
	<link rel="modulepreload" href="/docs/course/pr_299/vi/_app/assets/pages/__layout.svelte-hf-doc-builder.css">
	<link rel="modulepreload" href="/docs/course/pr_299/vi/_app/start-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_299/vi/_app/chunks/vendor-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_299/vi/_app/chunks/paths-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_299/vi/_app/pages/__layout.svelte-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_299/vi/_app/pages/chapter3/3.mdx-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_299/vi/_app/chunks/Tip-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_299/vi/_app/chunks/Youtube-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_299/vi/_app/chunks/IconCopyLink-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_299/vi/_app/chunks/CodeBlock-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_299/vi/_app/chunks/DocNotebookDropdown-hf-doc-builder.js">
	<link rel="modulepreload" href="/docs/course/pr_299/vi/_app/chunks/FrameworkSwitchCourse-hf-doc-builder.js"> 





<div class="bg-white leading-none border border-gray-100 rounded-lg flex p-0.5 w-56 text-sm mb-4"><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-l bg-red-50 dark:bg-transparent text-red-600" href="?fw=pt"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><defs><clipPath id="a"><rect x="3.05" y="0.5" width="25.73" height="31" fill="none"></rect></clipPath></defs><g clip-path="url(#a)"><path d="M24.94,9.51a12.81,12.81,0,0,1,0,18.16,12.68,12.68,0,0,1-18,0,12.81,12.81,0,0,1,0-18.16l9-9V5l-.84.83-6,6a9.58,9.58,0,1,0,13.55,0ZM20.44,9a1.68,1.68,0,1,1,1.67-1.67A1.68,1.68,0,0,1,20.44,9Z" fill="#ee4c2c"></path></g></svg>
			Pytorch
		</a><a class="flex justify-center flex-1 py-1.5 px-2.5 focus:outline-none !no-underline rounded-r text-gray-500 filter grayscale" href="?fw=tf"><svg class="mr-1.5" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" focusable="false" role="img" width="0.94em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 274"><path d="M145.726 42.065v42.07l72.861 42.07v-42.07l-72.86-42.07zM0 84.135v42.07l36.43 21.03V105.17L0 84.135zm109.291 21.035l-36.43 21.034v126.2l36.43 21.035v-84.135l36.435 21.035v-42.07l-36.435-21.034V105.17z" fill="#E55B2D"></path><path d="M145.726 42.065L36.43 105.17v42.065l72.861-42.065v42.065l36.435-21.03v-84.14zM255.022 63.1l-36.435 21.035v42.07l36.435-21.035V63.1zm-72.865 84.135l-36.43 21.035v42.07l36.43-21.036v-42.07zm-36.43 63.104l-36.436-21.035v84.135l36.435-21.035V210.34z" fill="#ED8E24"></path><path d="M145.726 0L0 84.135l36.43 21.035l109.296-63.105l72.861 42.07L255.022 63.1L145.726 0zm0 126.204l-36.435 21.03l36.435 21.036l36.43-21.035l-36.43-21.03z" fill="#F8BF3C"></path></svg>
			TensorFlow
		</a></div>
<h1 class="relative group"><a id="tinh-chnh-mt-m-hnh-vi-trainer-api" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#tinh-chnh-mt-m-hnh-vi-trainer-api"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Tinh ch·ªânh m·ªôt m√¥ h√¨nh v·ªõi Trainer API
	</span></h1>



<div class="flex space-x-1 absolute z-10 right-0 top-0"><a href="https://colab.research.google.com/github/huggingface/notebooks/blob/master/course/chapter3/section3.ipynb" target="_blank"><img alt="Open In Colab" class="!m-0" src="https://colab.research.google.com/assets/colab-badge.svg"></a>
	<a href="https://studiolab.sagemaker.aws/import/github/huggingface/notebooks/blob/master/course/chapter3/section3.ipynb" target="_blank"><img alt="Open In Studio Lab" class="!m-0" src="https://studiolab.sagemaker.aws/studiolab.svg"></a></div>
<iframe class="w-full xl:w-4/6 h-80" src="https://www.youtube-nocookie.com/embed/nvBXf7s7vTI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>ü§ó Transformers cung c·∫•p l·ªõp <code>Trainer</code> ƒë·ªÉ gi√∫p b·∫°n tinh ch·ªânh b·∫•t k·ª≥ m√¥ h√¨nh hu·∫•n luy·ªán tr∆∞·ªõc n√†o m√† n√≥ cung c·∫•p tr√™n t·∫≠p d·ªØ li·ªáu c·ªßa b·∫°n. Khi b·∫°n ƒë√£ ho√†n th√†nh t·∫•t c·∫£ c√¥ng vi·ªác ti·ªÅn x·ª≠ l√Ω d·ªØ li·ªáu trong ph·∫ßn cu·ªëi c√πng, b·∫°n ch·ªâ c√≤n m·ªôt v√†i b∆∞·ªõc ƒë·ªÉ ƒë·ªãnh nghƒ©a <code>Trainer</code>. Ph·∫ßn kh√≥ nh·∫•t c√≥ th·ªÉ l√† chu·∫©n b·ªã m√¥i tr∆∞·ªùng ƒë·ªÉ ch·∫°y <code>Trainer.train()</code>, v√¨ n√≥ s·∫Ω ch·∫°y r·∫•t ch·∫≠m tr√™n CPU. N·∫øu b·∫°n ch∆∞a thi·∫øt l·∫≠p GPU, b·∫°n c√≥ th·ªÉ c√≥ quy·ªÅn truy c·∫≠p v√†o GPU ho·∫∑c TPU mi·ªÖn ph√≠ tr√™n <a href="https://colab.research.google.com/" rel="nofollow">Google Colab</a>.</p>
<p>C√°c v√≠ d·ª• m√£ b√™n d∆∞·ªõi gi·∫£ s·ª≠ b·∫°n ƒë√£ th·ª±c hi·ªán c√°c v√≠ d·ª• trong ph·∫ßn tr∆∞·ªõc. D∆∞·ªõi ƒë√¢y l√† m·ªôt b·∫£n t√≥m t·∫Øt ng·∫Øn t√≥m t·∫Øt l·∫°i nh·ªØng g√¨ b·∫°n c·∫ßn:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> datasets <span class="hljs-keyword">import</span> load_dataset
<span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoTokenizer, DataCollatorWithPadding

raw_datasets = load_dataset(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mrpc&quot;</span>)
checkpoint = <span class="hljs-string">&quot;bert-base-uncased&quot;</span>
tokenizer = AutoTokenizer.from_pretrained(checkpoint)


<span class="hljs-keyword">def</span> <span class="hljs-title function_">tokenize_function</span>(<span class="hljs-params">example</span>):
    <span class="hljs-keyword">return</span> tokenizer(example[<span class="hljs-string">&quot;sentence1&quot;</span>], example[<span class="hljs-string">&quot;sentence2&quot;</span>], truncation=<span class="hljs-literal">True</span>)


tokenized_datasets = raw_datasets.<span class="hljs-built_in">map</span>(tokenize_function, batched=<span class="hljs-literal">True</span>)
data_collator = DataCollatorWithPadding(tokenizer=tokenizer)<!-- HTML_TAG_END --></pre></div>
<h3 class="relative group"><a id="hun-luyn" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#hun-luyn"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>Hu·∫•n luy·ªán
	</span></h3>

<p>B∆∞·ªõc ƒë·∫ßu ti√™n tr∆∞·ªõc khi ch√∫ng ta c√≥ th·ªÉ ƒë·ªãnh nghƒ©a <code>Trainer</code> c·ªßa m√¨nh l√† ƒë·ªãnh nghƒ©a m·ªôt l·ªõp <code>TrainingArguments</code> s·∫Ω ch·ª©a t·∫•t c·∫£ c√°c si√™u tham s·ªë m√† <code>Trainer</code> s·∫Ω s·ª≠ d·ª•ng ƒë·ªÉ hu·∫•n luy·ªán v√† ƒë√°nh gi√°. Tham s·ªë duy nh·∫•t b·∫°n ph·∫£i cung c·∫•p l√† m·ªôt th∆∞ m·ª•c n∆°i m√¥ h√¨nh ƒë∆∞·ª£c hu·∫•n luy·ªán s·∫Ω ƒë∆∞·ª£c l∆∞u, c≈©ng nh∆∞ c√°c checkpoint ƒëi k√®m. ƒê·ªëi v·ªõi t·∫•t c·∫£ ph·∫ßn c√≤n l·∫°i, b·∫°n c√≥ th·ªÉ ƒë·ªÉ m·∫∑c ƒë·ªãnh, n√≥ s·∫Ω ho·∫°t ƒë·ªông kh√° t·ªët v·ªõi tinh ch·ªânh c∆° b·∫£n.</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> TrainingArguments

training_args = TrainingArguments(<span class="hljs-string">&quot;test-trainer&quot;</span>)<!-- HTML_TAG_END --></pre></div>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>üí° N·∫øu b·∫°n mu·ªën t·ª± ƒë·ªông t·∫£i m√¥ h√¨nh c·ªßa m√¨nh l√™n Hub trong qu√° tr√¨nh hu·∫•n luy·ªán, h√£y chuy·ªÉn sang ph·∫ßn <code>push_to_hub=True</code> trong ph·∫ßn <code>TrainingArguments</code>. Ch√∫ng ta s·∫Ω t√¨m hi·ªÉu th√™m v·ªÅ ƒëi·ªÅu n√†y trong <a href="/course/chapter4/3">Ch∆∞∆°ng 4</a></p></div>
<p>B∆∞·ªõc th·ª© hai l√† x√°c ƒë·ªãnh m√¥ h√¨nh c·ªßa ch√∫ng ta. Nh∆∞ trong <a href="/course/chapter2">ch∆∞∆°ng tr∆∞·ªõc</a>, ch√∫ng ta s·∫Ω s·ª≠ d·ª•ng l·ªõp <code>AutoModelForSequenceClassification</code>, v·ªõi hai nh√£n:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> AutoModelForSequenceClassification

model = AutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=<span class="hljs-number">2</span>)<!-- HTML_TAG_END --></pre></div>
<p>B·∫°n s·∫Ω nh·∫≠n th·∫•y r·∫±ng kh√¥ng nh∆∞ trong <a href="/course/chapter2">Ch∆∞∆°ng 2</a>, b·∫°n nh·∫≠n ƒë∆∞·ª£c m·ªôt c·∫£nh b√°o sau khi kh·ªüi t·∫°o m√¥ h√¨nh ƒë∆∞·ª£c hu·∫•n luy·ªán tr∆∞·ªõc n√†y. ƒê√¢y l√† do BERT ch∆∞a ƒë∆∞·ª£c hu·∫•n luy·ªán tr∆∞·ªõc v·ªÅ ph√¢n lo·∫°i c√°c c·∫∑p c√¢u, v√¨ v·∫≠y ph·∫ßn ƒë·∫ßu c·ªßa m√¥ h√¨nh ƒë∆∞·ª£c hu·∫•n luy·ªán tr∆∞·ªõc ƒë√£ b·ªã lo·∫°i b·ªè v√† ph·∫ßn ƒë·∫ßu m·ªõi ph√π h·ª£p ƒë·ªÉ ph√¢n lo·∫°i chu·ªói ƒë√£ ƒë∆∞·ª£c ch√®n v√†o thay th·∫ø. C√°c c·∫£nh b√°o ch·ªâ ra r·∫±ng m·ªôt s·ªë tr·ªçng s·ªë ƒë√£ kh√¥ng ƒë∆∞·ª£c s·ª≠ d·ª•ng (nh·ªØng tr·ªçng s·ªë t∆∞∆°ng ·ª©ng v·ªõi ƒë·∫ßu hu·∫•n luy·ªán tr∆∞·ªõc b·ªã r·ª•ng) v√† m·ªôt s·ªë tr·ªçng s·ªë kh√°c kh√°c ƒë∆∞·ª£c kh·ªüi t·∫°o ng·∫´u nhi√™n (nh·ªØng tr·ªçng s·ªë d√†nh cho ƒë·∫ßu m·ªõi). N√≥ k·∫øt th√∫c b·∫±ng c√°ch khuy·∫øn kh√≠ch b·∫°n hu·∫•n luy·ªán m√¥ h√¨nh, ƒë√≥ ch√≠nh x√°c l√† nh·ªØng g√¨ ch√∫ng ta s·∫Ω l√†m b√¢y gi·ªù.</p>
<p>Khi ch√∫ng ta c√≥ m√¥ h√¨nh c·ªßa m√¨nh, ch√∫ng ta c√≥ th·ªÉ x√°c ƒë·ªãnh m·ªôt <code>Trainer</code> b·∫±ng c√°ch truy·ªÅn v√†o t·∫•t c·∫£ c√°c ƒë·ªëi t∆∞·ª£ng ƒë∆∞·ª£c x√¢y d·ª±ng t·ª´ tr∆∞·ªõc ƒë·∫øn nay - <code>model</code>, <code>training_args</code>, t·∫≠p hu·∫•n luy·ªán v√† ki·ªÉm ƒë·ªãnh,<code>data_collator</code> v√† <code>tokenizer</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">from</span> transformers <span class="hljs-keyword">import</span> Trainer

trainer = Trainer(
    model,
    training_args,
    train_dataset=tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    eval_dataset=tokenized_datasets[<span class="hljs-string">&quot;validation&quot;</span>],
    data_collator=data_collator,
    tokenizer=tokenizer,
)<!-- HTML_TAG_END --></pre></div>
<p>L∆∞u √Ω r·∫±ng khi b·∫°n truy·ªÅn <code>tokenizer</code> nh∆∞ ch√∫ng ta ƒë√£ l√†m ·ªü ƒë√¢y, m·∫∑c ƒë·ªãnh <code>data_collator</code> ƒë∆∞·ª£c s·ª≠ d·ª•ng b·ªüi <code>Trainer</code> s·∫Ω l√† <code>DataCollatorWithPadding</code> nh∆∞ ƒë√£ ƒë·ªãnh nghƒ©a tr∆∞·ªõc ƒë√≥, v√¨ v·∫≠y b·∫°n c√≥ th·ªÉ b·ªè qua d√≤ng <code>data_collator = data_collator</code> trong l·ªánh g·ªçi n√†y. ƒêi·ªÅu quan tr·ªçng l√† ph·∫£i cho b·∫°n th·∫•y ph·∫ßn n√†y c·ªßa qu√° tr√¨nh trong ph·∫ßn 2!</p>
<p>ƒê·ªÉ tinh ch·ªânh m√¥ h√¨nh tr√™n t·∫≠p d·ªØ li·ªáu, ch√∫ng ta ch·ªâ c·∫ßn g·ªçi ph∆∞∆°ng th·ª©c <code>train()</code> c·ªßa <code>Trainer</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.train()<!-- HTML_TAG_END --></pre></div>
<p>Thao t√°c n√†y s·∫Ω b·∫Øt ƒë·∫ßu qu√° tr√¨nh tinh ch·ªânh (s·∫Ω m·∫•t v√†i ph√∫t tr√™n GPU) v√† b√°o c√°o l·ªói ƒë√†o t·∫°o sau m·ªói 500 b∆∞·ªõc. Tuy nhi√™n, n√≥ s·∫Ω kh√¥ng cho b·∫°n bi·∫øt m√¥ h√¨nh c·ªßa b·∫°n ƒëang ho·∫°t ƒë·ªông t·ªët (ho·∫∑c t·ªìi t·ªá nh∆∞ th·∫ø n√†o). ƒêi·ªÅu n√†y l√† do:</p>
<ol><li>Ch√∫ng ta ƒë√£ kh√¥ng y√™u c·∫ßu <code>Trainer</code> ƒë√°nh gi√° trong qu√° tr√¨nh hu·∫•n luy·ªán b·∫±ng c√°ch c√†i ƒë·∫∑t <code>eval_strategy</code> th√†nh <code>&quot;steps&quot;</code> (ƒë√°nh gi√° m·ªçi <code>eval_steps</code>) ho·∫∑c <code>&quot;epoch&quot;</code> (ƒë√°nh gi√° v√†o cu·ªëi m·ªói epoch).</li>
<li>Ch√∫ng ta ƒë√£ kh√¥ng cung c·∫•p cho <code>Trainer</code> m·ªôt h√†m <code>compute_metrics()</code> ƒë·ªÉ t√≠nh to√°n ch·ªâ s·ªë trong qu√° tr√¨nh ƒë√°nh gi√° n√≥i tr√™n (n·∫øu kh√¥ng, ƒë√°nh gi√° s·∫Ω ch·ªâ in ra l·ªó, ƒë√¢y kh√¥ng ph·∫£i l√† m·ªôt ch·ªâ s·ªë tr·ª±c quan cho l·∫Øm).</li></ol>
<h3 class="relative group"><a id="nh-gi" class="header-link block pr-1.5 text-lg no-hover:hidden with-hover:absolute with-hover:p-1.5 with-hover:opacity-0 with-hover:group-hover:opacity-100 with-hover:right-full" href="#nh-gi"><span><svg class="" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" aria-hidden="true" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 256 256"><path d="M167.594 88.393a8.001 8.001 0 0 1 0 11.314l-67.882 67.882a8 8 0 1 1-11.314-11.315l67.882-67.881a8.003 8.003 0 0 1 11.314 0zm-28.287 84.86l-28.284 28.284a40 40 0 0 1-56.567-56.567l28.284-28.284a8 8 0 0 0-11.315-11.315l-28.284 28.284a56 56 0 0 0 79.196 79.197l28.285-28.285a8 8 0 1 0-11.315-11.314zM212.852 43.14a56.002 56.002 0 0 0-79.196 0l-28.284 28.284a8 8 0 1 0 11.314 11.314l28.284-28.284a40 40 0 0 1 56.568 56.567l-28.285 28.285a8 8 0 0 0 11.315 11.314l28.284-28.284a56.065 56.065 0 0 0 0-79.196z" fill="currentColor"></path></svg></span></a>
	<span>ƒê√°nh gi√°
	</span></h3>

<p>H√£y xem c√°ch ch√∫ng ta c√≥ th·ªÉ x√¢y d·ª±ng m·ªôt h√†m <code>compute_metrics()</code> h·ªØu √≠ch v√† s·ª≠ d·ª•ng n√≥ trong l·∫ßn hu·∫•n luy·ªán ti·∫øp theo. H√†m ph·∫£i nh·∫≠n m·ªôt ƒë·ªëi t∆∞·ª£ng <code>EvalPrediction</code> (l√† m·ªôt tuple ƒë∆∞·ª£c ƒë·∫∑t t√™n v·ªõi tr∆∞·ªùng <code>predictions</code> v√† tr∆∞·ªùng <code>label_ids</code>) v√† s·∫Ω tr·∫£ v·ªÅ m·ªôt chu·ªói √°nh x·∫° t·ª´ th√†nh s·ªë th·ª±c (c√°c chu·ªói l√† t√™n c·ªßa c√°c ch·ªâ s·ªë ƒë∆∞·ª£c tr·∫£ v·ªÅ v√† c√°c gi√° tr·ªã c·ªßa ch√∫ng √©p v·ªÅ ki·ªÉu s·ªë th·ª±c). ƒê·ªÉ nh·∫≠n ƒë∆∞·ª£c d·ª± ƒëo√°n t·ª´ m√¥ h√¨nh, ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng l·ªánh <code>Trainer.predict()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->predictions = trainer.predict(tokenized_datasets[<span class="hljs-string">&quot;validation&quot;</span>])
<span class="hljs-built_in">print</span>(predictions.predictions.shape, predictions.label_ids.shape)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->(<span class="hljs-number">408</span>, <span class="hljs-number">2</span>) (<span class="hljs-number">408</span>,)<!-- HTML_TAG_END --></pre></div>
<p>ƒê·∫ßu ra c·ªßa ph∆∞∆°ng th·ª©c <code>predict()</code> l√† m·ªôt tuple c√≥ t√™n kh√°c v·ªõi ba tr∆∞·ªùng: <code>predictions</code>, <code>label_ids</code>, v√† <code>metrics</code>. Tr∆∞·ªùng <code>metrics</code> s·∫Ω ch·ªâ ch·ª©a s·ª± m·∫•t m√°t tr√™n t·∫≠p d·ªØ li·ªáu ƒë√£ truy·ªÅn v√†o, c≈©ng nh∆∞ m·ªôt s·ªë ch·ªâ s·ªë th·ªùi gian (t·ªïng c·ªông v√† trung b√¨nh m·∫•t bao l√¢u ƒë·ªÉ d·ª± ƒëo√°n). Sau khi ch√∫ng ta ho√†n th√†nh h√†m <code>compute_metrics()</code> v√† truy·ªÅn n√≥ v√†o <code>Trainer</code>, tr∆∞·ªùng ƒë√≥ c≈©ng s·∫Ω ch·ª©a c√°c ch·ªâ s·ªë ƒë∆∞·ª£c tr·∫£ v·ªÅ b·ªüi<code>compute_metrics()</code>.</p>
<p>Nh∆∞ b·∫°n c√≥ th·ªÉ th·∫•y, <code>predictions</code> l√† m·ªôt m·∫£ng hai chi·ªÅu c√≥ h√¨nh d·∫°ng 408 x 2 (408 l√† s·ªë ph·∫ßn t·ª≠ trong t·∫≠p d·ªØ li·ªáu ta ƒë√£ s·ª≠ d·ª•ng). ƒê√≥ l√† c√°c logit cho t·ª´ng ph·∫ßn t·ª≠ c·ªßa t·∫≠p d·ªØ li·ªáu m√† ch√∫ng ta ƒë√£ truy·ªÅn v√†o cho<code>predict()</code> ( nh∆∞ b·∫°n ƒë√£ th·∫•y trong <a href="/course/chapter2">ch∆∞∆°ng tr∆∞·ªõc</a>, t·∫•t c·∫£ c√°c m√¥ h√¨nh Transformer ƒë·ªÅu tr·∫£ v·ªÅ logit). ƒê·ªÉ chuy·ªÉn ƒë·ªïi ch√∫ng th√†nh c√°c d·ª± ƒëo√°n m√† ch√∫ng ta c√≥ th·ªÉ so s√°nh v·ªõi c√°c nh√£n c·ªßa m√¨nh, ch√∫ng ta c·∫ßn l·∫•y ch·ªâ s·ªë c√≥ gi√° tr·ªã l·ªõn nh·∫•t tr√™n tr·ª•c th·ª© hai:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> numpy <span class="hljs-keyword">as</span> np

preds = np.argmax(predictions.predictions, axis=-<span class="hljs-number">1</span>)<!-- HTML_TAG_END --></pre></div>
<p>Gi·ªù ch√∫ng ta c√≥ th·ªÉ so s√°nh c√°c <code>preds</code> ƒë√≥ v·ªõi c√°c nh√£n. ƒê·ªÉ x√¢y d·ª±ng h√†m <code>compute_metric()</code>, ch√∫ng ta s·∫Ω d·ª±a v√†o c√°c ch·ªâ s·ªë t·ª´ th∆∞ vi·ªán ü§ó <a href="https://github.com/huggingface/evaluate/" rel="nofollow">ƒê√°nh gi√°</a>. Ch√∫ng ta c√≥ th·ªÉ t·∫£i c√°c ch·ªâ s·ªë ƒë∆∞·ª£c li√™n k·∫øt v·ªõi t·∫≠p d·ªØ li·ªáu MRPC d·ªÖ d√†ng nh∆∞ khi ch√∫ng ta t·∫£i t·∫≠p d·ªØ li·ªáu, l·∫ßn n√†y l√† v·ªõi h√†m <code>evaluate.load()</code>. ƒê·ªëi t∆∞·ª£ng ƒë∆∞·ª£c tr·∫£ v·ªÅ c√≥ ph∆∞∆°ng th·ª©c <code>compute()</code> m√† ch√∫ng ta c√≥ th·ªÉ s·ª≠ d·ª•ng ƒë·ªÉ th·ª±c hi·ªán t√≠nh to√°n s·ªë li·ªáu:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">import</span> evaluate

metric = evaluate.load(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mrpc&quot;</span>)
metric.compute(predictions=preds, references=predictions.label_ids)<!-- HTML_TAG_END --></pre></div>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->{<span class="hljs-string">&#x27;accuracy&#x27;</span>: <span class="hljs-number">0.8578431372549019</span>, <span class="hljs-string">&#x27;f1&#x27;</span>: <span class="hljs-number">0.8996539792387542</span>}<!-- HTML_TAG_END --></pre></div>
<p>K·∫øt qu·∫£ ch√≠nh x√°c b·∫°n nh·∫≠n ƒë∆∞·ª£c c√≥ th·ªÉ kh√°c nhau, v√¨ vi·ªác kh·ªüi t·∫°o ng·∫´u nhi√™n ph·∫ßn ƒë·∫ßu m√¥ h√¨nh c√≥ th·ªÉ thay ƒë·ªïi c√°c ch·ªâ s·ªë m√† n√≥ ƒë·∫°t ƒë∆∞·ª£c. ·ªû ƒë√¢y, ch√∫ng ta c√≥ th·ªÉ th·∫•y m√¥ h√¨nh c√≥ ƒë·ªô ch√≠nh x√°c 85.78% tr√™n t·∫≠p ki·ªÉm ƒë·ªãnh v√† ƒëi·ªÉm F1 l√† 89.97. ƒê√≥ l√† hai ch·ªâ s·ªë ƒë∆∞·ª£c s·ª≠ d·ª•ng ƒë·ªÉ ƒë√°nh gi√° k·∫øt qu·∫£ tr√™n t·∫≠p d·ªØ li·ªáu MRPC theo ƒëi·ªÉm chu·∫©n GLUE. B·∫£ng trong <a href="https://arxiv.org/pdf/1810.04805.pdf" rel="nofollow">b√†i b√°o BERT</a> b√°o c√°o ƒëi·ªÉm F1 l√† 88.9 cho m√¥ h√¨nh c∆° s·ªü. ƒê√≥ l√† m√¥ h√¨nh <code>kh√¥ng ph√¢n bi·ªát</code> vi·∫øt hoa vi·∫øt th∆∞·ªùng trong khi ch√∫ng ta hi·ªán ƒëang s·ª≠ d·ª•ng m√¥ h√¨nh <code>c√≥ ph√¢n bi·ªát</code>, ƒëi·ªÅu n√†y gi·∫£i th√≠ch k·∫øt qu·∫£ t·ªët h∆°n.</p>
<p>K·∫øt h·ª£p m·ªçi th·ª© l·∫°i v·ªõi nhau, ch√∫ng ta nh·∫≠n ƒë∆∞·ª£c h√†m <code>compute_metrics()</code>:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START --><span class="hljs-keyword">def</span> <span class="hljs-title function_">compute_metrics</span>(<span class="hljs-params">eval_preds</span>):
    metric = evaluate.load(<span class="hljs-string">&quot;glue&quot;</span>, <span class="hljs-string">&quot;mrpc&quot;</span>)
    logits, labels = eval_preds
    predictions = np.argmax(logits, axis=-<span class="hljs-number">1</span>)
    <span class="hljs-keyword">return</span> metric.compute(predictions=predictions, references=labels)<!-- HTML_TAG_END --></pre></div>
<p>V√† ƒë·ªÉ xem n√≥ ƒë∆∞·ª£c s·ª≠ d·ª•ng trong th·ª±c ti·ªÖn ƒë·ªÉ b√°o c√°o c√°c ch·ªâ s·ªë ·ªü cu·ªëi m·ªói epoch nh∆∞ th·∫ø n√†o, ƒë√¢y l√† c√°ch ch√∫ng t√¥i ƒë·ªãnh nghƒ©a m·ªôt <code>Trainer</code> m·ªõi v·ªõi h√†m <code>compute_metrics()</code> n√†y:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->training_args = TrainingArguments(<span class="hljs-string">&quot;test-trainer&quot;</span>, evaluation_strategy=<span class="hljs-string">&quot;epoch&quot;</span>)
model = AutoModelForSequenceClassification.from_pretrained(checkpoint, num_labels=<span class="hljs-number">2</span>)

trainer = Trainer(
    model,
    training_args,
    train_dataset=tokenized_datasets[<span class="hljs-string">&quot;train&quot;</span>],
    eval_dataset=tokenized_datasets[<span class="hljs-string">&quot;validation&quot;</span>],
    data_collator=data_collator,
    tokenizer=tokenizer,
    compute_metrics=compute_metrics,
)<!-- HTML_TAG_END --></pre></div>
<p>L∆∞u √Ω r·∫±ng ch√∫ng ta t·∫°o m·ªôt <code>TrainingArguments</code> m·ªõi v·ªõi <code>eval_strategy</code> c·ªßa n√≥ ƒë∆∞·ª£c ƒë·∫∑t th√†nh <code>&quot;epoch&quot;</code> v√† m·ªôt m√¥ h√¨nh m·ªõi - n·∫øu kh√¥ng, ch√∫ng ta s·∫Ω ti·∫øp t·ª•c hu·∫•n luy·ªán m√¥ h√¨nh ta ƒë√£ hu·∫•n luy·ªán. ƒê·ªÉ kh·ªüi ch·∫°y m·ªôt ƒë·ª£t hu·∫•n luy·ªán m·ªõi, ch√∫ng ta th·ª±c hi·ªán:</p>

	<div class="code-block relative"><div class="absolute top-2.5 right-4"><button class="inline-flex items-center relative text-sm focus:text-green-500 cursor-pointer focus:outline-none transition duration-200 ease-in-out opacity-0 mx-0.5   text-gray-600 " title="code excerpt" type="button"><svg class="" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" fill="currentColor" focusable="false" role="img" width="1em" height="1em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 32 32"><path d="M28,10V28H10V10H28m0-2H10a2,2,0,0,0-2,2V28a2,2,0,0,0,2,2H28a2,2,0,0,0,2-2V10a2,2,0,0,0-2-2Z" transform="translate(0)"></path><path d="M4,18H2V4A2,2,0,0,1,4,2H18V4H4Z" transform="translate(0)"></path><rect fill="none" width="32" height="32"></rect></svg>
	<div class="absolute pointer-events-none transition-opacity bg-black text-white py-1 px-2 leading-tight rounded font-normal shadow left-1/2 top-full transform -translate-x-1/2 translate-y-2 opacity-0"><div class="absolute bottom-full left-1/2 transform -translate-x-1/2 w-0 h-0 border-black border-4 border-t-0" style="border-left-color: transparent; border-right-color: transparent; "></div>
	Copied</div></button></div>
	<pre><!-- HTML_TAG_START -->trainer.trai<span class="hljs-meta">n</span>()<!-- HTML_TAG_END --></pre></div>
<p>L·∫ßn n√†y, n√≥ s·∫Ω b√°o c√°o th√¥ng s·ªë m·∫•t m√°t ki·ªÉm ƒë·ªãnh v√† ch·ªâ s·ªë ·ªü cu·ªëi m·ªói epoch √™n c·∫°nh th√¥ng s·ªë m·∫•t m√°t tr√™n t·∫≠p hu·∫•n luy·ªán. M·ªôt l·∫ßn n·ªØa, ƒë·ªô ch√≠nh x√°c tuy·ªát ƒë·ªëi/ƒëi·ªÉm F1 m√† b·∫°n ƒë·∫°t ƒë∆∞·ª£c c√≥ th·ªÉ h∆°i kh√°c so v·ªõi nh·ªØng g√¨ ch√∫ng t√¥i t√¨m th·∫•y, do vi·ªác kh·ªüi t·∫°o ƒë·∫ßu ng·∫´u nhi√™n c·ªßa m√¥ h√¨nh, nh∆∞ng n√≥ ph·∫£i ·ªü trong c√πng m·ªôt kho·∫£ng.</p>
<p><code>Trainer</code> s·∫Ω ho·∫°t ƒë·ªông hi·ªáu qu·∫£ tr√™n nhi·ªÅu GPU ho·∫∑c TPU v√† cung c·∫•p nhi·ªÅu t√πy ch·ªçn, ch·∫≥ng h·∫°n nh∆∞ hu·∫•n luy·ªán v·ªÅ ƒë·ªô ch√≠nh x√°c h·ªón h·ª£p (s·ª≠ d·ª•ng <code>fp16=True</code> trong tham s·ªë hu·∫•n luy·ªán c·ªßa b·∫°n). Ch√∫ng ta s·∫Ω xem x√©t m·ªçi th·ª© m√† n√≥ h·ªó tr·ª£ trong Ch∆∞∆°ng 10.</p>
<p>Ph·∫ßn n√†y k·∫øt th√∫c ph·∫ßn gi·ªõi thi·ªáu v·ªÅ c√°ch tinh ch·ªânh b·∫±ng API <code>Trainer</code>. M·ªôt v√≠ d·ª• v·ªÅ vi·ªác th·ª±c hi·ªán ƒëi·ªÅu n√†y ƒë·ªëi v·ªõi h·∫ßu h·∫øt c√°c t√°c v·ª• NLP ph·ªï bi·∫øn s·∫Ω ƒë∆∞·ª£c ƒë∆∞a ra trong <a href="/course/chapter7">Ch∆∞∆°ng 7</a>, nh∆∞ng ·ªü th·ªùi ƒëi·ªÉm n√†y ch√∫ng ta h√£y xem c√°ch th·ª±c hi·ªán ƒëi·ªÅu t∆∞∆°ng t·ª± trong PyTorch thu·∫ßn t√∫y.</p>


<div class="course-tip  bg-gradient-to-br dark:bg-gradient-to-r before:border-green-500 dark:before:border-green-800 from-green-50 dark:from-gray-900 to-white dark:to-gray-950 border border-green-50 text-green-700 dark:text-gray-400"><p>‚úèÔ∏è <strong>Th·ª≠ nghi·ªám th√¥i!</strong> Tinh ch·ªânh m√¥ h√¨nh tr√™n t·∫≠p d·ªØ li·ªáu GLUE SST-2, s·ª≠ d·ª•ng qu√° tr√¨nh x·ª≠ l√Ω d·ªØ li·ªáu b·∫°n ƒë√£ th·ª±c hi·ªán trong ph·∫ßn 2.</p></div>


		<script type="module" data-hydrate="txqrc8">
		import { start } from "/docs/course/pr_299/vi/_app/start-hf-doc-builder.js";
		start({
			target: document.querySelector('[data-hydrate="txqrc8"]').parentNode,
			paths: {"base":"/docs/course/pr_299/vi","assets":"/docs/course/pr_299/vi"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/docs/course/pr_299/vi/_app/pages/__layout.svelte-hf-doc-builder.js"),
						import("/docs/course/pr_299/vi/_app/pages/chapter3/3.mdx-hf-doc-builder.js")
				],
				params: {}
			}
		});
	</script>
